!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(hp){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e,a,n,r=t(hp),i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function w(t,s,a,u){return new(a=a||Promise)(function(n,e){function r(t){try{o(u.next(t))}catch(t){e(t)}}function i(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,i)}o((u=u.apply(t,s||[])).next())})}function b(n,r){var i,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}(n=a=a||{})[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT";function h(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=f[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,u(["["+i+"]  "+t.name+":"],n))}}var c={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},l=a.INFO,f=((e={})[a.DEBUG]="log",e[a.VERBOSE]="log",e[a.INFO]="info",e[a.WARN]="warn",e[a.ERROR]="error",e),p=(Object.defineProperty(d.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in a))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),d.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?c[t]:t},Object.defineProperty(d.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),d.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,a.DEBUG],t)),this._logHandler.apply(this,u([this,a.DEBUG],t))},d.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,a.VERBOSE],t)),this._logHandler.apply(this,u([this,a.VERBOSE],t))},d.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,a.INFO],t)),this._logHandler.apply(this,u([this,a.INFO],t))},d.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,a.WARN],t)),this._logHandler.apply(this,u([this,a.WARN],t))},d.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,a.ERROR],t)),this._logHandler.apply(this,u([this,a.ERROR],t))},d);function d(t){this.name=t,this._logLevel=l,this._logHandler=h,this._userLogHandler=null}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var y,g="FirebaseError",m=(o(E,y=Error),E);function E(t,e){var n=y.call(this,e)||this;return n.code=t,n.name=g,Object.setPrototypeOf(n,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,I.prototype.create),n}var I=(T.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],a=s?(r=i,s.replace(A,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",u=this.serviceName+": "+a+" ("+o+").",h=new m(o,u),c=0,l=Object.keys(i);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=i[f])}return h},T);function T(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var A=/\{\$([^}]+)}/g,N=function(t,e){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function R(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var S,k="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},D={},L=k||self;function O(){}function P(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function V(t){var e=P(t);return"array"==e||"object"==e&&"number"==typeof t.length}function _(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var U="closure_uid_"+(1e9*Math.random()>>>0),C=0;function j(t,e,n){return t.call.apply(t.bind,arguments)}function M(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function x(t,e,n){return(x=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?j:M).apply(null,arguments)}function B(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var F=Date.now;function q(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function G(){this.j=this.j,this.i=this.i}G.prototype.j=!1,G.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,U)&&t[U]||(t[U]=++C))},G.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var z=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},W=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Q(t){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function X(t){return/^[\s\xa0]*$/.test(t)}var Y,K=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function J(t,e){return-1!=t.indexOf(e)}function Z(t,e){return t<e?-1:e<t?1:0}t:{var $=L.navigator;if($){var tt=$.userAgent;if(tt){Y=tt;break t}}Y=""}function et(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function nt(t){var e,n={};for(e in t)n[e]=t[e];return n}var rt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function it(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<rt.length;o++)n=rt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ot(t){return ot[" "](t),t}ot[" "]=O;var st,at,ut=J(Y,"Opera"),ht=J(Y,"Trident")||J(Y,"MSIE"),ct=J(Y,"Edge"),lt=ct||ht,ft=J(Y,"Gecko")&&!(J(Y.toLowerCase(),"webkit")&&!J(Y,"Edge"))&&!(J(Y,"Trident")||J(Y,"MSIE"))&&!J(Y,"Edge"),pt=J(Y.toLowerCase(),"webkit")&&!J(Y,"Edge");function dt(){var t=L.document;return t?t.documentMode:void 0}t:{var vt="",yt=(at=Y,ft?/rv:([^\);]+)(\)|;)/.exec(at):ct?/Edge\/([\d\.]+)/.exec(at):ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(at):pt?/WebKit\/(\S+)/.exec(at):ut?/(?:Version)[ \/]?(\S+)/.exec(at):void 0);if(yt&&(vt=yt?yt[1]:""),ht){var gt=dt();if(null!=gt&&gt>parseFloat(vt)){st=String(gt);break t}}st=vt}var mt={};function wt(a){return t=a,e=function(){for(var t=0,e=K(String(st)).split("."),n=K(String(a)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Z(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Z(0==o[2].length,0==s[2].length)||Z(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=mt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var bt=L.document&&ht?dt()||(parseInt(st,10)||void 0):void 0,Et=!ht||9<=Number(bt),It=ht&&!wt("9"),Tt=function(){if(!L.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{L.addEventListener("test",O,e),L.removeEventListener("test",O,e)}catch(t){}return t}();function At(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Nt(t,e){if(At.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ft){t:{try{ot(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Rt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}At.prototype.b=function(){this.defaultPrevented=!0},q(Nt,At);var Rt={2:"touch",3:"pen",4:"mouse"};Nt.prototype.b=function(){Nt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,It)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var St="closure_listenable_"+(1e6*Math.random()|0),kt=0;function Dt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++kt,this.Y=this.Z=!1}function Lt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Ot(t){this.src=t,this.a={},this.b=0}function Pt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=z(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Lt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Vt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Ot.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Vt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Dt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var _t="closure_lm_"+(1e6*Math.random()|0),Ut={};function Ct(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=zt(r);return e&&e[St]?e.wa(n,r,_(i)?!!i.capture:!!i,o):jt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ct(t,e[o],n,r,i);return null}return n=zt(n),t&&t[St]?t.va(e,n,_(r)?!!r.capture:!!r,i):jt(t,e,n,!1,r,i)}function jt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=_(i)?!!i.capture:!!i;if(s&&!Et)return null;var a,u,h=qt(t);if(h||(t[_t]=h=new Ot(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(a=Ft,r=u=Et?function(t){return a.call(u.src,u.listener,t)}:function(t){if(!(t=a.call(u.src,u.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Tt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(xt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Mt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[St]?Pt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(xt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=qt(e))?(Pt(n,t),0==n.b&&(n.src=null,e[_t]=null)):Lt(t)))}function xt(t){return t in Ut?Ut[t]:Ut[t]="on"+t}function Bt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Mt(t),n.call(r,e)}function Ft(t,e){if(t.Y)return!0;if(Et)return Bt(t,new Nt(e,this));if(!e)t:{e=["window","event"];for(var n=L,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Bt(t,e=new Nt(e,this))}function qt(t){return(t=t[_t])instanceof Ot?t:null}var Gt="__closure_events_fn_"+(1e9*Math.random()>>>0);function zt(e){return"function"==P(e)?e:(e[Gt]||(e[Gt]=function(t){return e.handleEvent(t)}),e[Gt])}function Wt(){G.call(this),this.c=new Ot(this),(this.J=this).C=null}function Qt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,a,u=e[o];u&&!u.Y&&u.capture==n&&(s=u.listener,a=u.ca||u.src,u.Z&&Pt(t.c,u),i=!1!==s.call(a,r)&&i)}return i&&!r.defaultPrevented}q(Wt,G),Wt.prototype[St]=!0,(S=Wt.prototype).addEventListener=function(t,e,n,r){Ct(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=_(i)?!!i.capture:!!i,r=zt(r),e&&e[St]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Vt(s=e.a[n],r,i,o))&&(Lt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&qt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Vt(n,r,i,o)),(r=-1<e?n[e]:null)&&Mt(r))}(this,t,e,n,r)},S.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new At(t,n):t instanceof At?t.target=t.target||n:(s=t,it(t=new At(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Qt(o,r,!0,t)&&s;if(s=Qt(o=t.a=n,r,!0,t)&&s,s=Qt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Qt(o=t.a=e[i],r,!1,t)&&s;return s},S.G=function(){if(Wt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Lt(n[r]);delete e.a[t],e.b--}}this.C=null},S.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},S.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ht=L.JSON.stringify;function Xt(){this.b=this.a=null}var Yt,Kt=(Jt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Jt(function(){return new Zt},function(t){t.reset()},100));function Jt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Zt(){this.next=this.b=this.a=null}function $t(t,e){var n;Yt||(n=L.Promise.resolve(void 0),Yt=function(){n.then(ne)}),te||(Yt(),te=!0),ee.add(t,e)}Xt.prototype.add=function(t,e){var n=Kt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Zt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var te=!(Zt.prototype.reset=function(){this.next=this.b=this.a=null}),ee=new Xt;function ne(){for(var t,e,n;n=e=void 0,n=null,(e=ee).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){L.setTimeout(function(){throw t},0)}(t)}var r=Kt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}te=!1}function re(t,e){Wt.call(this),this.b=t||1,this.a=e||L,this.f=x(this.Ya,this),this.g=F()}function ie(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function oe(t,e,n){if("function"==P(t))n&&(t=x(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=x(t.handleEvent,t)}return 2147483647<Number(e)?-1:L.setTimeout(t,e||0)}q(re,Wt),(S=re.prototype).aa=!1,S.M=null,S.Ya=function(){var t;this.aa&&(0<(t=F()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ie(this),this.start())))},S.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=F())},S.G=function(){re.S.G.call(this),ie(this),delete this.a};var se,ae,ue,he=(N(ae=le,ue=se=G),ae.prototype=null===ue?Object.create(ue):(ce.prototype=ue.prototype,new ce),le.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=oe(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},le.prototype.G=function(){se.prototype.G.call(this),this.a&&(L.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},le);function ce(){this.constructor=ae}function le(t,e,n){var r=se.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function fe(t){G.call(this),this.b=t,this.a={}}q(fe,G);var pe=[];function de(t,e,n,r){Array.isArray(n)||(n&&(pe[0]=n.toString()),n=pe);for(var i=0;i<n.length;i++){var o=Ct(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ve(t){et(t.a,function(t,e){this.a.hasOwnProperty(e)&&Mt(t)},t),t.a={}}function ye(){this.a=!0}function ge(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Ht(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}fe.prototype.G=function(){fe.S.G.call(this),ve(this)},fe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ye.prototype.info=function(){};var me=null;function we(){return me=me||new Wt}function be(t){At.call(this,"serverreachability",t)}function Ee(t){var e=we();e.dispatchEvent(new be(e))}function Ie(t){At.call(this,"statevent",t)}function Te(t){var e=we();e.dispatchEvent(new Ie(e))}function Ae(t){At.call(this,"timingevent",t)}function Ne(t,e){if("function"!=P(t))throw Error("Fn must not be null and must be a function");return L.setTimeout(function(){t()},e)}q(be,At),q(Ie,At),q(Ae,At);var Re={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Se={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function ke(){}function De(t){var e;return(e=t.a)||(e=t.a={}),e}function Le(){}ke.prototype.a=null;var Oe,Pe={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Ve(){At.call(this,"d")}function _e(){At.call(this,"c")}function Ue(){}function Ce(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new fe(this),this.P=je,t=lt?125:void 0,this.R=new re(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}q(Ve,At),q(_e,At),q(Ue,ke),Oe=new Ue;var je=45e3,Me={},xe={};function Be(t,e,n){t.H=1,t.i=un(en(e)),t.j=n,t.I=!0,Fe(t,null)}function Fe(t,e){t.u=F(),Ge(t),t.l=en(t.i);var s,a,u,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),En(n.b,"t",r),t.D=0,t.a=dr(t.g,t.g.C?e:null),0<t.O&&(t.F=new he(x(t.Ca,t,t.a),t.O)),de(t.J,t.a,"readystatechange",t.Wa),e=t.B?nt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Ee(1),s=t.c,a=t.m,u=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+a+"\n"+u+"\n"+t})}function qe(t,e,n){for(var r,i,o,s,a=!0;!t.A&&t.D<n.length;){var u=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?xe:(o=Number(i.substring(o,s)),isNaN(o)?Me:(s+=1)+o>i.length?xe:(i=i.substr(s,o),r.D=s+o,i)));if(u==xe){4==e&&(t.h=4,Te(14),a=!1),ge(t.c,t.f,null,"[Incomplete Response]");break}if(u==Me){t.h=4,Te(15),ge(t.c,t.f,n,"[Invalid Chunk]"),a=!1;break}ge(t.c,t.f,u,null),Xe(t,u)}4==e&&0==n.length&&(t.h=1,Te(16),a=!1),t.b=t.b&&a,a?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),sr(e),e.F=!0)):(ge(t.c,t.f,n,"[Invalid Chunked Response]"),He(t),Qe(t))}function Ge(t){t.U=F()+t.P,ze(t,t.P)}function ze(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ne(x(t.Ua,t),e)}function We(t){t.o&&(L.clearTimeout(t.o),t.o=null)}function Qe(t){0==t.g.v||t.A||hr(t.g,t)}function He(t){We(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ie(t.R),ve(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Xe(t,e){try{var n,r,i,o,s,a,u,h,c,l,f,p=t.g;if(0!=p.v&&(p.a==t||kn(p.b,t)))if(p.I=t.N,!t.C&&kn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var v=d;if(0==v[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;ur(p),Jn(p)}or(p),Te(18)}}else p.oa=v[1],0<p.oa-p.P&&v[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ne(x(p.Ra,p),6e3));if(Sn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else lr(p,11)}else if(!t.C&&p.a!=t||ur(p),!X(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++){v=e[d],p.P=v[0],v=v[1],2==p.v?"c"==v[0]?(p.J=v[1],p.ga=v[2],null!=(n=v[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=v[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=v[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(a=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=o.b).a&&(J(a,"spdy")||J(a,"quic")||J(a,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(Dn(u,u.b),u.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,an(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=F()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=pr(o,o.C?o.ga:null,o.fa),c.C?(Ln(o.b,c),l=c,(f=o.D)&&l.setTimeout(f),l.o&&(We(l),Ge(l)),o.a=c):ir(o),0<p.g.length&&tr(p)):"stop"!=v[0]&&"close"!=v[0]||lr(p,7):3==p.v&&("stop"==v[0]||"close"==v[0]?"stop"==v[0]?lr(p,7):Kn(p):"noop"!=v[0]&&p.f&&p.f.sa(v),p.o=0)}Ee(4)}catch(t){}}function Ye(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(V(t)||"string"==typeof t)W(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(V(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(V(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ke(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ke)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Je(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ze(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ze(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(S=Ce.prototype).setTimeout=function(t){this.P=t},S.Wa=function(t){t=t.target;var e=this.F;e&&3==Qn(t)?e.f():this.Ca(t)},S.Ca=function(t){try{if(t==this.a)t:{var e=Qn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!lt&&!this.a.$())){this.A||4!=e||7==n||Ee(8==n||r<=0?3:2),We(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,h=this.c,c=this.m,l=this.l,f=this.f,p=this.T,d=e,v=i,h.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+p+"]: "+c+"\n"+l+"\n"+d+" "+v}),this.b){if(this.V&&!this.C){e:{if(this.a){var s,a=this.a;if((s=a.a?a.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!X(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,Te(12),He(this),Qe(this);break t}ge(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Xe(this,u)}this.I?(qe(this,e,o),lt&&this.b&&3==e&&(de(this.J,this.R,"tick",this.Va),this.R.start())):(ge(this.c,this.f,o,null),Xe(this,o)),4==e&&He(this),this.b&&!this.A&&(4==e?hr(this.g,this):(this.b=!1,Ge(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Te(12)):(this.h=0,Te(13)),He(this),Qe(this)}}}catch(t){}var h,c,l,f,p,d,v},S.Va=function(){var t,e;this.a&&(t=Qn(this.a),e=this.a.$(),this.D<e.length&&(We(this),qe(this,t,e),this.b&&4!=t&&Ge(this)))},S.cancel=function(){this.A=!0,He(this)},S.Ua=function(){this.o=null;var t,e,n=F();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(Ee(3),Te(17)),He(this),this.h=2,Qe(this)):ze(this,this.U-n)},(S=Ke.prototype).K=function(){Je(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},S.L=function(){return Je(this),this.a.concat()},S.get=function(t,e){return Ze(this.b,t)?this.b[t]:e},S.set=function(t,e){Ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},S.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var $e=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function tn(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof tn?(this.a=void 0!==e?e:t.a,nn(this,t.f),this.j=t.j,rn(this,t.c),on(this,t.h),this.g=t.g,e=t.b,(n=new gn).c=e.c,e.a&&(n.a=new Ke(e.a),n.b=e.b),sn(this,n),this.i=t.i):t&&(n=String(t).match($e))?(this.a=!!e,nn(this,n[1]||"",!0),this.j=hn(n[2]||""),rn(this,n[3]||"",!0),on(this,n[4]),this.g=hn(n[5]||"",!0),sn(this,n[6]||"",!0),this.i=hn(n[7]||"")):(this.a=!!e,this.b=new gn(null,this.a))}function en(t){return new tn(t)}function nn(t,e,n){t.f=n?hn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function rn(t,e,n){t.c=n?hn(e,!0):e}function on(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function sn(t,e,n){var r,i;e instanceof gn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(mn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(wn(this,e),En(this,n,t))},r)),r.f=i):(n||(e=cn(e,vn)),t.b=new gn(e,t.a))}function an(t,e,n){t.b.set(e,n)}function un(t){return an(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^F()).toString(36)),t}function hn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function cn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,ln),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ln(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}tn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(cn(e,fn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(cn(e,fn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(cn(n,"/"==n.charAt(0)?dn:pn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",cn(n,yn)),t.join("")};var fn=/[#\/\?@]/g,pn=/[#\?:]/g,dn=/[#\?]/g,vn=/[#\?@]/g,yn=/#/g;function gn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function mn(n){n.a||(n.a=new Ke,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function wn(t,e){mn(t),e=In(t,e),Ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ze((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Je(t)))}function bn(t,e){return mn(t),e=In(t,e),Ze(t.a.b,e)}function En(t,e,n){wn(t,e),0<n.length&&(t.c=null,t.a.set(In(t,e),H(n)),t.b+=n.length)}function In(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Tn(t,e){this.b=t,this.a=e}function An(t){this.g=t||Nn,t=L.PerformanceNavigationTiming?0<(t=L.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(L.ia&&L.ia.ya&&L.ia.ya()&&L.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(S=gn.prototype).add=function(t,e){mn(this),this.c=null,t=In(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},S.forEach=function(n,r){mn(this),this.a.forEach(function(t,e){W(t,function(t){n.call(r,t,e,this)},this)},this)},S.L=function(){mn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},S.K=function(t){mn(this);var e=[];if("string"==typeof t)bn(this,t)&&(e=Q(e,this.a.get(In(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=Q(e,t[n])}return e},S.set=function(t,e){return mn(this),this.c=null,bn(this,t=In(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},S.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},S.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var Nn=10;function Rn(t){return t.b||t.a&&t.a.size>=t.f}function Sn(t){return t.b?1:t.a?t.a.size:0}function kn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Dn(t,e){t.a?t.a.add(e):t.b=e}function Ln(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function On(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return H(t.c);var r=t.c;try{for(var i=R(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Pn(){}function Vn(){this.a=new Pn}function _n(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}An.prototype.cancel=function(){var e,t;if(this.c=On(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=R(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Pn.prototype.stringify=function(t){return L.JSON.stringify(t,void 0)},Pn.prototype.parse=function(t){return L.JSON.parse(t,void 0)};var Un=L.JSON.parse;function Cn(t){Wt.call(this),this.headers=new Ke,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=jn,this.D=this.F=!1}q(Cn,Wt);var jn="",Mn=/^https?$/i,xn=["POST","PUT"];function Bn(t){return"content-type"==t.toLowerCase()}function Fn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,qn(t),zn(t)}function qn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Gn(t){if(t.b&&void 0!==D&&(!t.s[1]||4!=Qn(t)||2!=t.X()))if(t.l&&4==Qn(t))oe(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Qn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match($e)[1]||null)&&L.self&&L.self.location&&(i=(r=L.self.location.protocol).substr(0,r.length-1)),n=!Mn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<Qn(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.X()+"]",qn(t)}}finally{zn(t)}}}function zn(t,e){if(t.a){Wn(t);var n=t.a,r=t.s[0]?O:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Wn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(L.clearTimeout(t.m),t.m=null)}function Qn(t){return t.a?t.a.readyState:0}function Hn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",et(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):an(t,e,n))}function Xn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Yn(t){this.pa=0,this.g=[],this.c=new ye,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Xn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Xn("baseRetryDelayMs",5e3,t),this.Ma=Xn("retryDelaySeedMs",1e4,t),this.Ja=Xn("forwardChannelMaxRetries",2,t),this.ma=Xn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new An(t&&t.concurrentRequestLimit),this.ka=new Vn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Kn(t){var e,n;Zn(t),3==t.v&&(e=t.R++,an(n=en(t.B),"SID",t.J),an(n,"RID",e),an(n,"TYPE","terminate"),nr(t,n),(e=new Ce(t,t.c,e,void 0)).H=2,e.i=un(en(n)),n=!1,L.navigator&&L.navigator.sendBeacon&&(n=L.navigator.sendBeacon(e.i.toString(),"")),!n&&L.Image&&((new Image).src=e.i,n=!0),n||(e.a=dr(e.g,null),e.a.ba(e.i)),e.u=F(),Ge(e)),fr(t)}function Jn(t){t.a&&(sr(t),t.a.cancel(),t.a=null)}function Zn(t){Jn(t),t.j&&(L.clearTimeout(t.j),t.j=null),ur(t),t.b.cancel(),t.h&&("number"==typeof t.h&&L.clearTimeout(t.h),t.h=null)}function $n(t,e){t.g.push(new Tn(t.La++,e)),3==t.v&&tr(t)}function tr(t){Rn(t.b)||t.h||(t.h=!0,$t(t.Ba,t),t.u=0)}function er(t,e){var n=e?e.f:t.R++,r=en(t.B);an(r,"SID",t.J),an(r,"RID",n),an(r,"AID",t.P),nr(t,r),t.i&&t.l&&Hn(r,t.i,t.l),n=new Ce(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=rr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Dn(t.b,n),Be(n,r,e)}function nr(t,n){t.f&&Ye({},function(t,e){an(n,e,t)})}function rr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?x(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var h=i[u].b,c=i[u].a;if((h-=o)<0)o=Math.max(0,i[u].b-100),a=!1;else try{!function(t,r,e){var i=e||"";try{Ye(t,function(t,e){var n=t;_(t)&&(n=Ht(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function ir(t){t.a||t.j||(t.U=1,$t(t.Aa,t),t.o=0)}function or(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ne(x(t.Aa,t),cr(t,t.o)),t.o++,1)}function sr(t){null!=t.s&&(L.clearTimeout(t.s),t.s=null)}function ar(t){t.a=new Ce(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=en(t.la);an(e,"RID","rpc"),an(e,"SID",t.J),an(e,"CI",t.H?"0":"1"),an(e,"AID",t.P),nr(t,e),an(e,"TYPE","xmlhttp"),t.i&&t.l&&Hn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=un(en(e)),n.j=null,n.I=!0,Fe(n,t)}function ur(t){null!=t.m&&(L.clearTimeout(t.m),t.m=null)}function hr(t,e){var n,r=null;if(t.a==e){ur(t),sr(t),t.a=null;var i=2}else{if(!kn(t.b,e))return;r=e.s,Ln(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=F()-e.u,n=t.u,(i=we()).dispatchEvent(new Ae(i)),tr(t)):ir(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Sn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ne(x(t.Ba,t,e),cr(t,t.u)),t.u++,1}}(t,e)||2==i&&or(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:lr(t,5);break;case 4:lr(t,10);break;case 3:lr(t,6);break;default:lr(t,2)}}function cr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function lr(t,e){var n,r,i,o,s,a;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=x(t.Xa,t),n||(n=new tn("//www.google.com/images/cleardot.gif"),L.location&&"http"==L.location.protocol||nn(n,"https"),un(n)),i=n.toString(),o=r,a=new ye,L.Image?((s=new Image).onload=B(_n,a,s,"TestLoadImage: loaded",!0,o),s.onerror=B(_n,a,s,"TestLoadImage: error",!1,o),s.onabort=B(_n,a,s,"TestLoadImage: abort",!1,o),s.ontimeout=B(_n,a,s,"TestLoadImage: timeout",!1,o),L.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):Te(2),t.v=0,t.f&&t.f.ra(e),fr(t),Zn(t)}function fr(t){t.v=0,t.I=-1,t.f&&(0==On(t.b).length&&0==t.g.length||(t.b.c.length=0,H(t.g),t.g.length=0),t.f.qa())}function pr(t,e,n){var r,i,o,s,a,u,h,c=(r=n)instanceof tn?en(r):new tn(r,void 0);return""!=c.c?(e&&rn(c,e+"."+c.c),on(c,c.h)):(i=L.location,o=i.protocol,s=e?e+"."+i.hostname:i.hostname,a=+i.port,u=n,h=new tn(null,void 0),o&&nn(h,o),s&&rn(h,s),a&&on(h,a),u&&(h.g=u),c=h),t.W&&et(t.W,function(t,e){an(c,e,t)}),e=t.A,n=t.na,e&&n&&an(c,e,n),an(c,"VER",t.ha),nr(t,c),c}function dr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Cn(t.Ka)).F=t.C,e}function vr(){}function yr(){if(ht&&!(10<=Number(bt)))throw Error("Environmental error: no available transport.")}function gr(t,e){Wt.call(this),this.a=new Yn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!X(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!X(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new br(this)}function mr(t){Ve.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function wr(){_e.call(this),this.status=1}function br(t){this.a=t}(S=Cn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?De(this.H):De(Oe),this.a.onreadystatechange=x(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Fn(this,t)}t=n||"";var i,o=new Ke(this.headers);r&&Ye(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Bn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=L.FormData&&t instanceof L.FormData,0<=z(xn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Wn(this),0<this.o&&((this.D=(i=this.a,ht&&wt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=x(this.xa,this)):this.m=oe(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Fn(this,t)}},S.xa=function(){void 0!==D&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},S.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),zn(this))},S.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),zn(this,!0)),Cn.S.G.call(this)},S.za=function(){this.j||(this.A||this.l||this.g?Gn(this):this.Ta())},S.Ta=function(){Gn(this)},S.X=function(){try{return 2<Qn(this)?this.a.status:-1}catch(t){return-1}},S.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},S.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Un(e)}},S.ua=function(){return this.h},S.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(S=Yn.prototype).ha=8,S.v=1,S.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ce(this,this.c,t,void 0),r=this.l;if(this.O&&(r?it(r=nt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=rr(this,n,e),an(i=en(this.B),"RID",t),an(i,"CVER",22),this.A&&an(i,"X-HTTP-Session-Id",this.A),nr(this,i),this.i&&r&&Hn(i,this.i,r),Dn(this.b,n),this.Ga&&an(i,"TYPE","init"),this.da?(an(i,"$req",e),an(i,"SID","null"),n.V=!0,Be(n,i,null)):Be(n,i,e),this.v=2}}else 3==this.v&&(t?er(this,t):0==this.g.length||Rn(this.b)||er(this))},S.Aa=function(){var t;this.j=null,ar(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ne(x(this.Sa,this),t))},S.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Jn(this),ar(this))},S.Ra=function(){null!=this.m&&(this.m=null,Jn(this),or(this),Te(19))},S.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),Te(2)):(this.c.info("Failed to ping google.com"),Te(1))},(S=vr.prototype).ta=function(){},S.sa=function(){},S.ra=function(){},S.qa=function(){},S.Ha=function(){},yr.prototype.a=function(t,e){return new gr(t,e)},q(gr,Wt),(S=gr.prototype).addEventListener=function(t,e,n,r){gr.S.addEventListener.call(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){gr.S.removeEventListener.call(this,t,e,n,r)},S.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Te(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=pr(t,null,t.fa),tr(t)},S.close=function(){Kn(this.a)},S.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,$n(this.a,e)):this.g?((e={}).__data__=Ht(t),$n(this.a,e)):$n(this.a,t)},S.G=function(){this.a.f=null,delete this.f,Kn(this.a),delete this.a,gr.S.G.call(this)},q(mr,Ve),q(wr,_e),q(br,vr),br.prototype.ta=function(){this.a.dispatchEvent("a")},br.prototype.sa=function(t){this.a.dispatchEvent(new mr(t))},br.prototype.ra=function(t){this.a.dispatchEvent(new wr)},br.prototype.qa=function(){this.a.dispatchEvent("b")},yr.prototype.createWebChannel=yr.prototype.a,gr.prototype.send=gr.prototype.Pa,gr.prototype.open=gr.prototype.Oa,Re.NO_ERROR=0,Re.TIMEOUT=8,Re.HTTP_ERROR=6,Se.COMPLETE="complete",(Le.EventType=Pe).OPEN="a",Pe.CLOSE="b",Pe.ERROR="c",Pe.MESSAGE="d",Wt.prototype.listen=Wt.prototype.va,Cn.prototype.listenOnce=Cn.prototype.wa,Cn.prototype.getLastError=Cn.prototype.Qa,Cn.prototype.getLastErrorCode=Cn.prototype.ua,Cn.prototype.getStatus=Cn.prototype.X,Cn.prototype.getResponseJson=Cn.prototype.Na,Cn.prototype.getResponseText=Cn.prototype.$,Cn.prototype.send=Cn.prototype.ba;var Er={createWebChannelTransport:function(){return new yr},ErrorCode:Re,EventType:Se,WebChannel:Le,XhrIo:Cn},Ir=Er.createWebChannelTransport,Tr=Er.ErrorCode,Ar=Er.EventType,Nr=Er.WebChannel,Rr=Er.XhrIo,Sr=(kr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},kr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},kr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},kr);function kr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Dr,Lr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Or=(o(_r,Dr=Error),_r),Pr="7.21.1-2020822235757",Vr=new p("@firebase/firestore");function _r(t,e){var n=this;return(n=Dr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Ur(){return Vr.logLevel}function Cr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Vr.logLevel<=a.DEBUG&&(e=n.map(xr),Vr.debug.apply(Vr,s(["Firestore ("+Pr+"): "+t],e)))}function jr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Vr.logLevel<=a.ERROR&&(e=n.map(xr),Vr.error.apply(Vr,s(["Firestore ("+Pr+"): "+t],e)))}function Mr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Vr.logLevel<=a.WARN&&(e=n.map(xr),Vr.warn.apply(Vr,s(["Firestore ("+Pr+"): "+t],e)))}function xr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Br(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Pr+") INTERNAL ASSERTION FAILED: "+t;throw jr(e),new Error(e)}function Fr(t){t||Br()}function qr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Gr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function zr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Wr,Qr,Hr=(Object.defineProperty(ei.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),ei.prototype.isEqual=function(t){return 0===ei.i(this,t)},ei.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ei?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},ei.prototype.limit=function(){return this.offset+this.length},ei.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},ei.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},ei.prototype.l=function(){return this.segments[this.offset]},ei.prototype._=function(){return this.get(this.length-1)},ei.prototype.get=function(t){return this.segments[this.offset+t]},ei.prototype.m=function(){return 0===this.length},ei.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ei.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ei.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ei.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},ei.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ei),Xr=(o(ti,Qr=Hr),ti.prototype.o=function(t,e,n){return new ti(t,e,n)},ti.prototype.R=function(){return this.A().join("/")},ti.prototype.toString=function(){return this.R()},ti.P=function(t){if(0<=t.indexOf("//"))throw new Or(Lr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ti(t.split("/").filter(function(t){return 0<t.length}))},ti.p=function(){return new ti([])},ti),Yr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Kr=(o($r,Wr=Hr),$r.prototype.o=function(t,e,n){return new $r(t,e,n)},$r.g=function(t){return Yr.test(t)},$r.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),$r.g(t)||(t="`"+t+"`"),t}).join(".")},$r.prototype.toString=function(){return this.R()},$r.prototype.V=function(){return 1===this.length&&"__name__"===this.get(0)},$r.v=function(){return new $r(["__name__"])},$r.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Or(Lr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Or(Lr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[r+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Or(Lr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Or(Lr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new $r(e)},$r.p=function(){return new $r([])},$r),Jr=(Zr.C=function(t){return new Zr(Xr.P(t))},Zr.D=function(t){return new Zr(Xr.P(t).u(5))},Zr.prototype.F=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Zr.prototype.isEqual=function(t){return null!==t&&0===Xr.i(this.path,t.path)},Zr.prototype.toString=function(){return this.path.toString()},Zr.i=function(t,e){return Xr.i(t.path,e.path)},Zr.N=function(t){return t.length%2==0},Zr.$=function(t){return new Zr(new Xr(t.slice()))},Zr);function Zr(t){this.path=t}function $r(){return null!==Wr&&Wr.apply(this,arguments)||this}function ti(){return null!==Qr&&Qr.apply(this,arguments)||this}function ei(t,e,n){void 0===e?e=0:e>t.length&&Br(),void 0===n?n=t.length-e:n>t.length-e&&Br(),this.segments=t,this.offset=e,this.t=n}function ni(t,e){if(0!==e.length)throw new Or(Lr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+bi(e.length,"argument")+".")}function ri(t,e,n){if(e.length!==n)throw new Or(Lr.INVALID_ARGUMENT,"Function "+t+"() requires "+bi(n,"argument")+", but was called with "+bi(e.length,"argument")+".")}function ii(t,e,n){if(e.length<n)throw new Or(Lr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+bi(n,"argument")+", but was called with "+bi(e.length,"argument")+".")}function oi(t,e,n,r){if(e.length<n||e.length>r)throw new Or(Lr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+bi(e.length,"argument")+".")}function si(t,e,n,r){fi(t,e,wi(n)+" argument",r)}function ai(t,e,n,r){void 0!==r&&si(t,e,n,r)}function ui(t,e,n,r){fi(t,e,n+" option",r)}function hi(t,e,n,r){void 0!==r&&ui(t,e,n,r)}function ci(t,e,n,r,u){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=u;i<o.length;i++){var s=o[i];if(s===n)return;r.push(di(s))}var a=di(n);throw new Or(Lr.INVALID_ARGUMENT,"Invalid value "+a+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function li(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Or(Lr.INVALID_ARGUMENT,"Invalid value "+di(r)+" provided to function "+t+"() for its "+wi(n)+" argument. Acceptable values: "+e.join(", "));return r}function fi(t,e,n,r){if(!("object"===e?pi(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=di(r);throw new Or(Lr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function pi(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function di(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Br();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function vi(t,e,n){if(void 0===n)throw new Or(Lr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+wi(e)+" argument, but it was undefined.")}function yi(n,t,r){Gr(t,function(t,e){if(r.indexOf(t)<0)throw new Or(Lr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function gi(t,e,n,r){var i=di(r);return new Or(Lr.INVALID_ARGUMENT,"Function "+t+"() requires its "+wi(n)+" argument to be a "+e+", but it was: "+i)}function mi(t,e,n){if(n<=0)throw new Or(Lr.INVALID_ARGUMENT,"Function "+t+"() requires its "+wi(e)+" argument to be a positive number, but it was: "+n+".")}function wi(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function bi(t,e){return t+" "+e+(1===t?"":"s")}var Ei=(Ii.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Ii);function Ii(){}function Ti(t,e){return t<e?-1:e<t?1:0}function Ai(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Ni=(Ri.fromBase64String=function(t){return new Ri(atob(t))},Ri.fromUint8Array=function(t){return new Ri(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ri.prototype.toBase64=function(){return t=this.O,btoa(t);var t},Ri.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.O)},Ri.prototype.M=function(){return 2*this.O.length},Ri.prototype.L=function(t){return Ti(this.O,t.O)},Ri.prototype.isEqual=function(t){return this.O===t.O},Ri);function Ri(t){this.O=t}Ni.q=new Ni("");var Si=(ki.fromBase64String=function(t){try{return new ki(Ni.fromBase64String(t))}catch(t){throw new Or(Lr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},ki.fromUint8Array=function(t){return new ki(Ni.fromUint8Array(t))},ki.prototype.toBase64=function(){return this.U.toBase64()},ki.prototype.toUint8Array=function(){return this.U.toUint8Array()},ki.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},ki.prototype.isEqual=function(t){return this.U.isEqual(t.U)},ki);function ki(t){this.U=t}function Di(){if("undefined"==typeof Uint8Array)throw new Or(Lr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Li(){if("undefined"==typeof atob)throw new Or(Lr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Oi(t,e,n,r,i){this.B=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Pi,Vi=(o(qi,Pi=Si),qi.fromBase64String=function(t){ri("Blob.fromBase64String",arguments,1),si("Blob.fromBase64String","string",1,t),Li();try{return new qi(Ni.fromBase64String(t))}catch(t){throw new Or(Lr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},qi.fromUint8Array=function(t){if(ri("Blob.fromUint8Array",arguments,1),Di(),!(t instanceof Uint8Array))throw gi("Blob.fromUint8Array","Uint8Array",1,t);return new qi(Ni.fromUint8Array(t))},qi.prototype.toBase64=function(){return ri("Blob.toBase64",arguments,0),Li(),Pi.prototype.toBase64.call(this)},qi.prototype.toUint8Array=function(){return ri("Blob.toUint8Array",arguments,0),Di(),Pi.prototype.toUint8Array.call(this)},qi.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},qi),_i=(Object.defineProperty(Fi.prototype,"j",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Fi.prototype.isEqual=function(t){return t instanceof Fi&&t.projectId===this.projectId&&t.database===this.database},Fi.prototype.L=function(t){return Ti(this.projectId,t.projectId)||Ti(this.database,t.database)},Fi),Ui=(Bi.prototype.get=function(t){var e=this.W(t),n=this.K[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.G(s,t))return a}},Bi.prototype.has=function(t){return void 0!==this.get(t)},Bi.prototype.set=function(t,e){var n=this.W(t),r=this.K[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.G(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.K[n]=[[t,e]]},Bi.prototype.delete=function(t){var e=this.W(t),n=this.K[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.G(n[r][0],t))return 1===n.length?delete this.K[e]:n.splice(r,1),!0;return!1},Bi.prototype.forEach=function(a){Gr(this.K,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];a(o,s)}})},Bi.prototype.m=function(){return zr(this.K)},Bi),Ci=(xi.now=function(){return xi.fromMillis(Date.now())},xi.fromDate=function(t){return xi.fromMillis(t.getTime())},xi.fromMillis=function(t){var e=Math.floor(t/1e3);return new xi(e,1e6*(t-1e3*e))},xi.prototype.toDate=function(){return new Date(this.toMillis())},xi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},xi.prototype.H=function(t){return this.seconds===t.seconds?Ti(this.nanoseconds,t.nanoseconds):Ti(this.seconds,t.seconds)},xi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},xi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},xi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},xi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},xi),ji=(Mi.Y=function(t){return new Mi(t)},Mi.min=function(){return new Mi(new Ci(0,0))},Mi.prototype.L=function(t){return this.timestamp.H(t.timestamp)},Mi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Mi.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Mi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Mi.prototype.X=function(){return this.timestamp},Mi);function Mi(t){this.timestamp=t}function xi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Or(Lr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Or(Lr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Or(Lr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Or(Lr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Bi(t,e){this.W=t,this.G=e,this.K={}}function Fi(t,e){this.projectId=t,this.database=e||"(default)"}function qi(){return null!==Pi&&Pi.apply(this,arguments)||this}function Gi(t){return null==t}function zi(t){return 0===t&&1/t==-1/0}var Wi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function Qi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Wi(t,e,n,r,i,o,s)}function Hi(t){var e,n=t;return null===n.Z&&(e=n.path.R(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.R()+e.op.toString()+Xo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.R()+e.dir;var e}).join(","),Gi(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=bu(n.startAt)),n.endAt&&(e+="|ub:",e+=bu(n.endAt)),n.Z=e),n.Z}function Xi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,a=0;a<t.filters.length;a++)if(o=t.filters[a],s=e.filters[a],o.op!==s.op||!o.field.isEqual(s.field)||!zo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Iu(t.startAt,e.startAt)&&Iu(t.endAt,e.endAt)}function Yi(t){return Jr.N(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Ki(t){this.count=t}var Ji,Zi,$i=(to.prototype.nt=function(t){return new to(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},to.prototype.st=function(t,e){return new to(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},to.prototype.it=function(t){return new to(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},to);function to(t,e,n,r,i,o,s){void 0===i&&(i=ji.min()),void 0===o&&(o=ji.min()),void 0===s&&(s=Ni.q),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function eo(t){switch(t){case Lr.OK:return Br(),0;case Lr.CANCELLED:case Lr.UNKNOWN:case Lr.DEADLINE_EXCEEDED:case Lr.RESOURCE_EXHAUSTED:case Lr.INTERNAL:case Lr.UNAVAILABLE:case Lr.UNAUTHENTICATED:return;case Lr.INVALID_ARGUMENT:case Lr.NOT_FOUND:case Lr.ALREADY_EXISTS:case Lr.PERMISSION_DENIED:case Lr.FAILED_PRECONDITION:case Lr.ABORTED:case Lr.OUT_OF_RANGE:case Lr.UNIMPLEMENTED:case Lr.DATA_LOSS:return 1;default:return Br(),0}}function no(t){if(void 0===t)return jr("GRPC error has no .code"),Lr.UNKNOWN;switch(t){case Ji.OK:return Lr.OK;case Ji.CANCELLED:return Lr.CANCELLED;case Ji.UNKNOWN:return Lr.UNKNOWN;case Ji.DEADLINE_EXCEEDED:return Lr.DEADLINE_EXCEEDED;case Ji.RESOURCE_EXHAUSTED:return Lr.RESOURCE_EXHAUSTED;case Ji.INTERNAL:return Lr.INTERNAL;case Ji.UNAVAILABLE:return Lr.UNAVAILABLE;case Ji.UNAUTHENTICATED:return Lr.UNAUTHENTICATED;case Ji.INVALID_ARGUMENT:return Lr.INVALID_ARGUMENT;case Ji.NOT_FOUND:return Lr.NOT_FOUND;case Ji.ALREADY_EXISTS:return Lr.ALREADY_EXISTS;case Ji.PERMISSION_DENIED:return Lr.PERMISSION_DENIED;case Ji.FAILED_PRECONDITION:return Lr.FAILED_PRECONDITION;case Ji.ABORTED:return Lr.ABORTED;case Ji.OUT_OF_RANGE:return Lr.OUT_OF_RANGE;case Ji.UNIMPLEMENTED:return Lr.UNIMPLEMENTED;case Ji.DATA_LOSS:return Lr.DATA_LOSS;default:return Br()}}(Zi=Ji=Ji||{})[Zi.OK=0]="OK",Zi[Zi.CANCELLED=1]="CANCELLED",Zi[Zi.UNKNOWN=2]="UNKNOWN",Zi[Zi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Zi[Zi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Zi[Zi.NOT_FOUND=5]="NOT_FOUND",Zi[Zi.ALREADY_EXISTS=6]="ALREADY_EXISTS",Zi[Zi.PERMISSION_DENIED=7]="PERMISSION_DENIED",Zi[Zi.UNAUTHENTICATED=16]="UNAUTHENTICATED",Zi[Zi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Zi[Zi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Zi[Zi.ABORTED=10]="ABORTED",Zi[Zi.OUT_OF_RANGE=11]="OUT_OF_RANGE",Zi[Zi.UNIMPLEMENTED=12]="UNIMPLEMENTED",Zi[Zi.INTERNAL=13]="INTERNAL",Zi[Zi.UNAVAILABLE=14]="UNAVAILABLE",Zi[Zi.DATA_LOSS=15]="DATA_LOSS";var ro=(uo.prototype.rt=function(t,e){return new uo(this.i,this.root.rt(t,e,this.i).copy(null,null,oo.ot,null,null))},uo.prototype.remove=function(t){return new uo(this.i,this.root.remove(t,this.i).copy(null,null,oo.ot,null,null))},uo.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},uo.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},uo.prototype.m=function(){return this.root.m()},Object.defineProperty(uo.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),uo.prototype.ut=function(){return this.root.ut()},uo.prototype.ct=function(){return this.root.ct()},uo.prototype.at=function(t){return this.root.at(t)},uo.prototype.forEach=function(n){this.at(function(t,e){return n(t,e),!1})},uo.prototype.toString=function(){var n=[];return this.at(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},uo.prototype.ht=function(t){return this.root.ht(t)},uo.prototype.lt=function(){return new io(this.root,null,this.i,!1)},uo.prototype._t=function(t){return new io(this.root,t,this.i,!1)},uo.prototype.ft=function(){return new io(this.root,null,this.i,!0)},uo.prototype.dt=function(t){return new io(this.root,t,this.i,!0)},uo),io=(ao.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},ao.prototype.It=function(){return 0<this.Tt.length},ao.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},ao),oo=(so.prototype.copy=function(t,e,n,r,i){return new so(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},so.prototype.m=function(){return!1},so.prototype.at=function(t){return this.left.at(t)||t(this.key,this.value)||this.right.at(t)},so.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},so.prototype.min=function(){return this.left.m()?this:this.left.min()},so.prototype.ut=function(){return this.min().key},so.prototype.ct=function(){return this.right.m()?this.key:this.right.ct()},so.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},so.prototype.yt=function(){if(this.left.m())return so.EMPTY;var t=this;return t.left.Pt()||t.left.left.Pt()||(t=t.gt()),(t=t.copy(null,null,null,t.left.yt(),null)).Rt()},so.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.Pt()||r.left.left.Pt()||(r=r.gt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Pt()&&(r=r.Vt()),r.right.m()||r.right.Pt()||r.right.left.Pt()||(r=r.vt()),0===e(t,r.key)){if(r.right.m())return so.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.yt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},so.prototype.Pt=function(){return this.color},so.prototype.Rt=function(){var t=this;return t.right.Pt()&&!t.left.Pt()&&(t=t.bt()),t.left.Pt()&&t.left.left.Pt()&&(t=t.Vt()),t.left.Pt()&&t.right.Pt()&&(t=t.St()),t},so.prototype.gt=function(){var t=this.St();return t.right.left.Pt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).bt()).St()),t},so.prototype.vt=function(){var t=this.St();return t.left.left.Pt()&&(t=(t=t.Vt()).St()),t},so.prototype.bt=function(){var t=this.copy(null,null,so.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},so.prototype.Vt=function(){var t=this.copy(null,null,so.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},so.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},so.prototype.Ct=function(){var t=this.Dt();return Math.pow(2,t)<=this.size+1},so.prototype.Dt=function(){if(this.Pt()&&this.left.Pt())throw Br();if(this.right.Pt())throw Br();var t=this.left.Dt();if(t!==this.right.Dt())throw Br();return t+(this.Pt()?0:1)},so);function so(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:so.RED,this.left=null!=r?r:so.EMPTY,this.right=null!=i?i:so.EMPTY,this.size=this.left.size+1+this.right.size}function ao(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function uo(t,e){this.i=t,this.root=e||oo.EMPTY}function ho(){this.size=0}oo.EMPTY=null,oo.RED=!0,oo.ot=!1,oo.EMPTY=(Object.defineProperty(ho.prototype,"key",{get:function(){throw Br()},enumerable:!1,configurable:!0}),Object.defineProperty(ho.prototype,"value",{get:function(){throw Br()},enumerable:!1,configurable:!0}),Object.defineProperty(ho.prototype,"color",{get:function(){throw Br()},enumerable:!1,configurable:!0}),Object.defineProperty(ho.prototype,"left",{get:function(){throw Br()},enumerable:!1,configurable:!0}),Object.defineProperty(ho.prototype,"right",{get:function(){throw Br()},enumerable:!1,configurable:!0}),ho.prototype.copy=function(t,e,n,r,i){return this},ho.prototype.rt=function(t,e,n){return new oo(t,e)},ho.prototype.remove=function(t,e){return this},ho.prototype.m=function(){return!0},ho.prototype.at=function(t){return!1},ho.prototype.ht=function(t){return!1},ho.prototype.ut=function(){return null},ho.prototype.ct=function(){return null},ho.prototype.Pt=function(){return!1},ho.prototype.Ct=function(){return!0},ho.prototype.Dt=function(){return 0},new ho);var co=(vo.prototype.has=function(t){return null!==this.data.get(t)},vo.prototype.first=function(){return this.data.ut()},vo.prototype.last=function(){return this.data.ct()},Object.defineProperty(vo.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),vo.prototype.indexOf=function(t){return this.data.indexOf(t)},vo.prototype.forEach=function(n){this.data.at(function(t,e){return n(t),!1})},vo.prototype.Ft=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(0<=this.i(r.key,t[1]))return;e(r.key)}},vo.prototype.Nt=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},vo.prototype.$t=function(t){var e=this.data._t(t);return e.It()?e.Et().key:null},vo.prototype.lt=function(){return new lo(this.data.lt())},vo.prototype._t=function(t){return new lo(this.data._t(t))},vo.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},vo.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},vo.prototype.m=function(){return this.data.m()},vo.prototype.xt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},vo.prototype.isEqual=function(t){if(!(t instanceof vo))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(0!==this.i(r,i))return!1}return!0},vo.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},vo.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},vo.prototype.copy=function(t){var e=new vo(this.i);return e.data=t,e},vo),lo=(po.prototype.Et=function(){return this.kt.Et().key},po.prototype.It=function(){return this.kt.It()},po),fo=new ro(Jr.i);function po(t){this.kt=t}function vo(t){this.i=t,this.data=new ro(this.i)}var yo=new ro(Jr.i);var go=new ro(Jr.i),mo=new co(Jr.i);function wo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=mo,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var bo=new co(Ti);var Eo=(jo.Lt=function(t){return new jo(t.i)},jo.prototype.has=function(t){return null!=this.Ot.get(t)},jo.prototype.get=function(t){return this.Ot.get(t)},jo.prototype.first=function(){return this.Mt.ut()},jo.prototype.last=function(){return this.Mt.ct()},jo.prototype.m=function(){return this.Mt.m()},jo.prototype.indexOf=function(t){var e=this.Ot.get(t);return e?this.Mt.indexOf(e):-1},Object.defineProperty(jo.prototype,"size",{get:function(){return this.Mt.size},enumerable:!1,configurable:!0}),jo.prototype.forEach=function(n){this.Mt.at(function(t,e){return n(t),!1})},jo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ot.rt(t.key,t),e.Mt.rt(t,null))},jo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ot.remove(t),this.Mt.remove(e)):this},jo.prototype.isEqual=function(t){if(!(t instanceof jo))return!1;if(this.size!==t.size)return!1;for(var e=this.Mt.lt(),n=t.Mt.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(!r.isEqual(i))return!1}return!0},jo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},jo.prototype.copy=function(t,e){var n=new jo;return n.i=this.i,n.Ot=t,n.Mt=e,n},jo),Io=(Co.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);!n||0!==t.type&&3===n.type?this.qt=this.qt.rt(e,t):3===t.type&&1!==n.type?this.qt=this.qt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.rt(e,{type:2,doc:t.doc}):Br()},Co.prototype.Ut=function(){var n=[];return this.qt.at(function(t,e){n.push(e)}),n},Co),To=(Uo.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Uo(t,e,Eo.Lt(e),i,n,r,!0,!1)},Object.defineProperty(Uo.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),Uo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Qt.isEqual(t.Qt)&&Ga(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Bt.isEqual(t.Bt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Uo),Ao=(_o.Jt=function(t,e){var n=new Map;return n.set(t,No.Xt(t,e)),new _o(ji.min(),n,bo,fo,wo())},_o),No=(Vo.Xt=function(t,e){return new Vo(Ni.q,e,wo(),wo(),wo())},Vo),Ro=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},So=function(t,e){this.targetId=t,this.re=e},ko=function(t,e,n,r){void 0===n&&(n=Ni.q),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Do=(Object.defineProperty(Po.prototype,"Zt",{get:function(){return this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(Po.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(Po.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(Po.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),Po.prototype.fe=function(t){0<t.M()&&(this.he=!0,this.ce=t)},Po.prototype.de=function(){var n=wo(),r=wo(),i=wo();return this.ue.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Br()}}),new No(this.ce,this.ae,n,r,i)},Po.prototype.we=function(){this.he=!1,this.ue=xo()},Po.prototype.me=function(t,e){this.he=!0,this.ue=this.ue.rt(t,e)},Po.prototype.Te=function(t){this.he=!0,this.ue=this.ue.remove(t)},Po.prototype.Ee=function(){this.oe+=1},Po.prototype.Ie=function(){--this.oe},Po.prototype.Ae=function(){this.he=!0,this.ae=!0},Po),Lo=(Oo.prototype.Ve=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof Na?this.ve(r,t.ie):t.ie instanceof Ra&&this.be(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.be(s,t.key,t.ie)}},Oo.prototype.Se=function(n){var r=this;this.Ce(n,function(t){var e=r.De(t);switch(n.state){case 0:r.Fe(t)&&e.fe(n.resumeToken);break;case 1:e.Ie(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ie(),e.le||r.removeTarget(t);break;case 3:r.Fe(t)&&(e.Ae(),e.fe(n.resumeToken));break;case 4:r.Fe(t)&&(r.Ne(t),e.fe(n.resumeToken));break;default:Br()}})},Oo.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ye.forEach(function(t,e){r.Fe(e)&&n(e)})},Oo.prototype.$e=function(t){var e,n,r=t.targetId,i=t.re.count,o=this.xe(r);o&&(Yi(e=o.target)?0===i?(n=new Jr(e.path),this.be(r,n,new Ra(n,ji.min()))):Fr(1===i):this.ke(r)!==i&&(this.Ne(r),this.ge=this.ge.add(r)))},Oo.prototype.Oe=function(i){var o=this,s=new Map;this.ye.forEach(function(t,e){var n,r=o.xe(e);r&&(t.Zt&&Yi(r.target)&&(n=new Jr(r.target.path),null!==o.Pe.get(n)||o.Me(e,n)||o.be(e,n,new Ra(n,i))),t._e&&(s.set(e,t.de()),t.we()))});var r=wo();this.pe.forEach(function(t,e){var n=!0;e.Nt(function(t){var e=o.xe(t);return!e||2===e.tt||(n=!1)}),n&&(r=r.add(t))});var t=new Ao(i,s,this.ge,this.Pe,r);return this.Pe=fo,this.pe=Mo(),this.ge=new co(Ti),t},Oo.prototype.ve=function(t,e){var n;this.Fe(t)&&(n=this.Me(t,e.key)?2:0,this.De(t).me(e.key,n),this.Pe=this.Pe.rt(e.key,e),this.pe=this.pe.rt(e.key,this.Le(e.key).add(t)))},Oo.prototype.be=function(t,e,n){var r;this.Fe(t)&&(r=this.De(t),this.Me(t,e)?r.me(e,1):r.Te(e),this.pe=this.pe.rt(e,this.Le(e).delete(t)),n&&(this.Pe=this.Pe.rt(e,n)))},Oo.prototype.removeTarget=function(t){this.ye.delete(t)},Oo.prototype.ke=function(t){var e=this.De(t).de();return this.Re.qe(t).size+e.te.size-e.ne.size},Oo.prototype.Ee=function(t){this.De(t).Ee()},Oo.prototype.De=function(t){var e=this.ye.get(t);return e||(e=new Do,this.ye.set(t,e)),e},Oo.prototype.Le=function(t){var e=this.pe.get(t);return e||(e=new co(Ti),this.pe=this.pe.rt(t,e)),e},Oo.prototype.Fe=function(t){var e=null!==this.xe(t);return e||Cr("WatchChangeAggregator","Detected inactive target",t),e},Oo.prototype.xe=function(t){var e=this.ye.get(t);return e&&e.le?null:this.Re.Ue(t)},Oo.prototype.Ne=function(e){var n=this;this.ye.set(e,new Do),this.Re.qe(e).forEach(function(t){n.be(e,t,null)})},Oo.prototype.Me=function(t,e){return this.Re.qe(t).has(e)},Oo);function Oo(t){this.Re=t,this.ye=new Map,this.Pe=fo,this.pe=Mo(),this.ge=new co(Ti)}function Po(){this.oe=0,this.ue=xo(),this.ce=Ni.q,this.ae=!1,this.he=!0}function Vo(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function _o(t,e,n,r,i){this.et=t,this.zt=e,this.Kt=n,this.Ht=r,this.Yt=i}function Uo(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.Bt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.jt=s,this.Wt=a}function Co(){this.qt=new ro(Jr.i)}function jo(n){this.i=n?function(t,e){return n(t,e)||Jr.i(t.key,e.key)}:function(t,e){return Jr.i(t.key,e.key)},this.Ot=yo,this.Mt=new ro(this.i)}function Mo(){return new ro(Jr.i)}function xo(){return new ro(Jr.i)}function Bo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Fo(t){var e=Yo(t.mapValue.fields.__local_write_time__.timestampValue);return new Ci(e.seconds,e.nanos)}var qo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Go(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Bo(t)?4:10:Br()}function zo(r,i){var t,e,n,o=Go(r);if(o!==Go(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Fo(r).isEqual(Fo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Yo(r.timestampValue),n=Yo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,Jo(r.bytesValue).isEqual(Jo(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Ko((t=r).geoPointValue.latitude)===Ko(e.geoPointValue.latitude)&&Ko(t.geoPointValue.longitude)===Ko(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ko(t.integerValue)===Ko(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Ko(t.doubleValue),r=Ko(e.doubleValue);return n===r?zi(n)===zi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Ai(r.arrayValue.values||[],i.arrayValue.values||[],zo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(qr(e)!==qr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!zo(e[t],n[t])))return!1;return!0}();default:return Br()}}function Wo(t,e){return void 0!==(t.values||[]).find(function(t){return zo(t,e)})}function Qo(t,e){var n,r,i,o,s,a,u,h,c,l,f=Go(t),p=Go(e);if(f!==p)return Ti(f,p);switch(f){case 0:return 0;case 1:return Ti(t.booleanValue,e.booleanValue);case 2:return h=e,c=Ko(t.integerValue||t.doubleValue),l=Ko(h.integerValue||h.doubleValue),c<l?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return Ho(t.timestampValue,e.timestampValue);case 4:return Ho(Fo(t),Fo(e));case 5:return Ti(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,a=Jo(o),u=Jo(s),a.L(u);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ti(n[i],r[i]);if(0!==o)return o}return Ti(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Ti(Ko(n.latitude),Ko(r.latitude)))?i:Ti(Ko(n.longitude),Ko(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Qo(n[i],r[i]);if(o)return o}return Ti(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Ti(r[s],o[s]);if(0!==a)return a;var u=Qo(n[r[s]],i[o[s]]);if(0!==u)return u}return Ti(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Br()}}function Ho(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ti(t,e);var n=Yo(t),r=Yo(e),i=Ti(n.seconds,r.seconds);return 0!==i?i:Ti(n.nanos,r.nanos)}function Xo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Yo(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Jo(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,Jr.D(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++){e?e=!1:t+=",",t+=s(r[n])}return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Br();var t,e,n}(t)}function Yo(t){if(Fr(!!t),"string"!=typeof t)return{seconds:Ko(t.seconds),nanos:Ko(t.nanos)};var e,n=0,r=qo.exec(t);Fr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function Ko(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Jo(t){return"string"==typeof t?Ni.fromBase64String(t):Ni.fromUint8Array(t)}function Zo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function $o(t){return t&&"integerValue"in t}function ts(t){return!!t&&"arrayValue"in t}function es(t){return t&&"nullValue"in t}function ns(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function rs(t){return t&&"mapValue"in t}var is={asc:"ASCENDING",desc:"DESCENDING"},os={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ss=function(t,e){this.B=t,this.Be=e};function as(t){return{integerValue:""+t}}function us(t,e){if(t.Be){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zi(e)?"-0":e}}function hs(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!zi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?as(e):us(t,e);var n}function cs(t,e){return t.Be?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ls(t,e){return t.Be?e.toBase64():e.toUint8Array()}function fs(t){return Fr(!!t),ji.Y((e=Yo(t),new Ci(e.seconds,e.nanos)));var e}function ps(t,e){return new Xr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function ds(t,e){return ps(t.B,e.path)}function vs(t,e){var n,r,i=(Fr(Ts(r=Xr.P(e))),r);return Fr(i.get(1)===t.B.projectId),Fr(!i.get(3)&&!t.B.database||i.get(3)===t.B.database),new Jr((Fr(4<(n=i).length&&"documents"===n.get(4)),n.u(5)))}function ys(t,e){return ps(t.B,e)}function gs(t){return new Xr(["projects",t.B.projectId,"databases",t.B.database]).R()}function ms(t,e,n){return{name:ds(t,e),fields:n.proto.mapValue.fields}}function ws(t,e){var n,r,i,o,s,a;if(e instanceof na)n={update:ms(t,e.key,e.value)};else if(e instanceof pa)n={delete:ds(t,e.key)};else if(e instanceof ra)n={update:ms(t,e.key,e.data),updateMask:(r=e.Qe,i=[],r.fields.forEach(function(t){return i.push(t.R())}),{fieldPaths:i})};else if(e instanceof ua)n={transform:{document:ds(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ks)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof Ds)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof _s)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Ms)return{fieldPath:t.field.R(),increment:e.je};throw Br()})}};else{if(!(e instanceof da))return Br();n={verify:ds(t,e.key)}}return e.Ge.We||(n.currentDocument=void 0!==(o=e.Ge).updateTime?{updateTime:(s=t,a=o.updateTime,cs(s,a.X()))}:void 0!==o.exists?{exists:o.exists}:Br()),n}function bs(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ys(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ys(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(ns(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NAN"}};if(es(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ns(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NOT_NAN"}};if(es(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Is(t.field),op:(e=t.op,os[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Is((e=t).field),direction:(n=e.dir,is[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,a=(s=e.limit,t.Be||Gi(s)?s:{value:s});return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=Es(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Es(e.endAt)),n}function Es(t){return{before:t.before,values:t.position}}function Is(t){return{fieldPath:t.R()}}function Ts(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function As(){this.ze=void 0}function Ns(t,e){return t instanceof Ms?$o(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Rs,Ss,ks=(o(Os,Ss=As),Os),Ds=(o(Ls,Rs=As),Ls);function Ls(t){var e=this;return(e=Rs.call(this)||this).elements=t,e}function Os(){return null!==Ss&&Ss.apply(this,arguments)||this}function Ps(t,e){for(var n=Fs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return zo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Vs,_s=(o(Us,Vs=As),Us);function Us(t){var e=this;return(e=Vs.call(this)||this).elements=t,e}function Cs(t,e){for(var n=Fs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!zo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var js,Ms=(o(xs,js=As),xs);function xs(t,e){var n=this;return(n=js.call(this)||this).serializer=t,n.je=e,n}function Bs(t){return Ko(t.integerValue||t.doubleValue)}function Fs(t){return ts(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function qs(t,e){this.field=t,this.transform=e}var Gs=(zs.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},zs.prototype.isEqual=function(t){return Ai(this.fields,t.fields,function(t,e){return t.isEqual(e)})},zs);function zs(t){(this.fields=t).sort(Kr.i)}function Ws(t,e){this.version=t,this.transformResults=e}var Qs=(Hs.He=function(){return new Hs},Hs.exists=function(t){return new Hs(void 0,t)},Hs.updateTime=function(t){return new Hs(t)},Object.defineProperty(Hs.prototype,"We",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Hs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Hs);function Hs(t,e){this.updateTime=t,this.exists=e}function Xs(t,e){return void 0!==t.updateTime?e instanceof Na&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Na}function Ys(){}function Ks(t,e,n){return t instanceof na?new Na(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof ra?function(t,e,n){if(!Xs(t.Ge,e))return new Sa(t.key,n.version);var r=sa(t,e);return new Na(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof ua?function(t,e,n){if(Fr(null!=n.transformResults),!Xs(t.Ge,e))return new Sa(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Fr(t.length===n.length);for(var i,o,s,a=0;a<n.length;a++){var u=t[a],h=u.transform,c=null;e instanceof Na&&(c=e.field(u.field)),r.push((i=h,o=c,s=n[a],i instanceof Ds?Ps(i,o):i instanceof _s?Cs(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=ca(t,r.data(),i);return new Na(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):new Ra(t.key,n.version,{hasCommittedMutations:!0})}function Js(t,e,n,r){return t instanceof na?function(t,e){if(!Xs(t.Ge,e))return e;var n=$s(e);return new Na(t.key,n,t.value,{Ye:!0})}(t,e):t instanceof ra?function(t,e){if(!Xs(t.Ge,e))return e;var n=$s(e),r=sa(t,e);return new Na(t.key,n,r,{Ye:!0})}(t,e):t instanceof ua?function(t,e,n,r){if(!Xs(t.Ge,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,a,u,h,c,l=[],f=0,p=t;f<p.length;f++){var d=p[f],v=d.transform,y=null;n instanceof Na&&(y=n.field(d.field)),null===y&&r instanceof Na&&(y=r.field(d.field)),l.push((o=y,s=e,c=h=u=a=void 0,(i=v)instanceof ks?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}},o&&(c.fields.__previous_value__=o),{mapValue:c}):i instanceof Ds?Ps(i,o):i instanceof _s?Cs(i,o):(u=Ns(a=i,o),h=Bs(u)+Bs(a.je),$o(u)&&$o(a.je)?as(h):us(a.serializer,h))))}return l}(t.fieldTransforms,n,e,r),s=ca(t,i.data(),o);return new Na(t.key,i.version,s,{Ye:!0})}(t,e,r,n):(o=e,Xs((i=t).Ge,o)?new Ra(i.key,ji.min()):o);var i,o}function Zs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Ai(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof Ds&&o instanceof Ds||i instanceof _s&&o instanceof _s?Ai(i.elements,o.elements,zo):i instanceof Ms&&o instanceof Ms?zo(i.je,o.je):i instanceof ks&&o instanceof ks);var n,r,i,o}))}function $s(t){return t instanceof Na?t.version:ji.min()}var ta,ea,na=(o(oa,ea=Ys),oa),ra=(o(ia,ta=Ys),ia);function ia(t,e,n,r){var i=this;return(i=ta.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function oa(t,e,n){var r=this;return(r=ea.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function sa(t,e){return n=t,r=e instanceof Na?e.data():va.empty(),i=new ya(r),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.Je();var n,r,i}var aa,ua=(o(ha,aa=Ys),ha);function ha(t,e){var n=this;return(n=aa.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=Qs.exists(!0),n}function ca(t,e,n){for(var r=new ya(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Je()}var la,fa,pa=(o(ba,fa=Ys),ba),da=(o(wa,la=Ys),wa),va=(ma.empty=function(){return new ma({mapValue:{}})},ma.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!rs(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},ma.prototype.isEqual=function(t){return zo(this.proto,t.proto)},ma),ya=(ga.prototype.set=function(t,e){return this.tn(t,e),this},ga.prototype.delete=function(t){return this.tn(t,null),this},ga.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Go(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},ga.prototype.Je=function(){var t=this.en(Kr.p(),this.Ze);return null!=t?new va(t):this.Xe},ga.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=rs(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},ga);function ga(t){void 0===t&&(t=va.empty()),this.Xe=t,this.Ze=new Map}function ma(t){this.proto=t}function wa(t,e){var n=this;return(n=la.call(this)||this).key=t,n.Ge=e,n.type=4,n}function ba(t,e){var n=this;return(n=fa.call(this)||this).key=t,n.Ge=e,n.type=3,n}function Ea(t,e){this.key=t,this.version=e}var Ia,Ta,Aa,Na=(o(Oa,Aa=Ea),Oa.prototype.field=function(t){return this.nn.field(t)},Oa.prototype.data=function(){return this.nn},Oa.prototype.sn=function(){return this.nn.proto},Oa.prototype.isEqual=function(t){return t instanceof Oa&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},Oa.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Oa.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Oa),Ra=(o(La,Ta=Ea),La.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(La.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),La.prototype.isEqual=function(t){return t instanceof La&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},La),Sa=(o(Da,Ia=Ea),Da.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Da.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Da.prototype.isEqual=function(t){return t instanceof Da&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Da),ka=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=a,this.un=null,this.cn=null,this.startAt,this.endAt};function Da(){return null!==Ia&&Ia.apply(this,arguments)||this}function La(t,e,n){var r=this;return(r=Ta.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Oa(t,e,n,r){var i=this;return(i=Aa.call(this,t,e)||this).nn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Pa(t){return new ka(t)}function Va(t){return!Gi(t.limit)&&"F"===t.on}function _a(t){return!Gi(t.limit)&&"L"===t.on}function Ua(t){return 0<t.rn.length?t.rn[0].field:null}function Ca(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.an())return r.field}return null}function ja(t){return null!==t.collectionGroup}function Ma(t){var e=t;if(null===e.un){e.un=[];var n=Ca(e),r=Ua(e);if(null!==n&&null===r)n.V()||e.un.push(new Tu(n)),e.un.push(new Tu(Kr.v(),"asc"));else{for(var i,o=!1,s=0,a=e.rn;s<a.length;s++){var u=a[s];e.un.push(u),u.field.V()&&(o=!0)}o||(i=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.un.push(new Tu(Kr.v(),i)))}}return e.un}function xa(t){var e=t;if(!e.cn)if("F"===e.on)e.cn=Qi(e.path,e.collectionGroup,Ma(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Ma(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Tu(o.field,s))}var a=e.endAt?new vu(e.endAt.position,!e.endAt.before):null,u=e.startAt?new vu(e.startAt.position,!e.startAt.before):null;e.cn=Qi(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.cn}function Ba(t,e,n){return new ka(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Fa(t,e){return new ka(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function qa(t,e){return new ka(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function Ga(t,e){return Xi(xa(t),xa(e))&&t.on===e.on}function za(t){return Hi(xa(t))+"|lt:"+t.on}function Wa(t){return"Query(target="+(e=xa(t),n=e.path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.R()+" "+e.op+" "+Xo(e.value);var e}).join(", ")+"]"),Gi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.R()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+bu(e.startAt)),e.endAt&&(n+=", endAt: "+bu(e.endAt)),"Target("+n+")")+"; limitType="+t.on+")";var e,n}function Qa(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.F(r.collectionGroup)&&r.path.T(o):Jr.N(r.path)?r.path.isEqual(o):r.path.I(o))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.V()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Eu(e.startAt,Ma(e),n))&&(!e.endAt||!Eu(e.endAt,Ma(e),n)));var e,n,r,o}function Ha(a){return function(t,e){for(var n=!1,r=0,i=Ma(a);r<i.length;r++){var o=i[r],s=function(t,i,e){var n=t.field.V()?Jr.i(i.key,e.key):function(t,e){var n=i.field(t),r=e.field(t);return null!==n&&null!==r?Qo(n,r):Br()}(t.field,e);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Br()}}(o,t,e);if(0!==s)return s;n=n||o.field.V()}return 0}}var Xa,Ya=(o(Ka,Xa=function(){}),Ka.create=function(t,e,n){if(t.V())return"in"===e||"not-in"===e?this.hn(t,e,n):new tu(t,e,n);if(es(n)){if("=="!==e&&"!="!==e)throw new Or(Lr.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new Ka(t,e,n)}if(ns(n)){if("=="!==e&&"!="!==e)throw new Or(Lr.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new Ka(t,e,n)}return"array-contains"===e?new lu(t,n):"in"===e?new fu(t,n):"not-in"===e?new pu(t,n):"array-contains-any"===e?new du(t,n):new Ka(t,e,n)},Ka.hn=function(t,e,n){return new("in"===e?eu:nu)(t,n)},Ka.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.ln(Qo(e,this.value)):null!==e&&Go(this.value)===Go(e)&&this.ln(Qo(e,this.value))},Ka.prototype.ln=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Br()}},Ka.prototype.an=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Ka);function Ka(t,e,n){var r=this;return(r=Xa.call(this)||this).field=t,r.op=e,r.value=n,r}var Ja,Za,$a,tu=(o(ou,$a=Ya),ou.prototype.matches=function(t){var e=Jr.i(t.key,this.key);return this.ln(e)},ou),eu=(o(iu,Za=Ya),iu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},iu),nu=(o(ru,Ja=Ya),ru.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},ru);function ru(t,e){var n=this;return(n=Ja.call(this,t,"not-in",e)||this).keys=su(0,e),n}function iu(t,e){var n=this;return(n=Za.call(this,t,"in",e)||this).keys=su(0,e),n}function ou(t,e,n){var r=this;return(r=$a.call(this,t,e,n)||this).key=Jr.D(n.referenceValue),r}function su(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Jr.D(t.referenceValue)})}var au,uu,hu,cu,lu=(o(wu,cu=Ya),wu.prototype.matches=function(t){var e=t.field(this.field);return ts(e)&&Wo(e.arrayValue,this.value)},wu),fu=(o(mu,hu=Ya),mu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Wo(this.value.arrayValue,e)},mu),pu=(o(gu,uu=Ya),gu.prototype.matches=function(t){if(Wo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!Wo(this.value.arrayValue,e)},gu),du=(o(yu,au=Ya),yu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!ts(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Wo(e.value.arrayValue,t)})},yu),vu=function(t,e){this.position=t,this.before=e};function yu(t,e){return au.call(this,t,"array-contains-any",e)||this}function gu(t,e){return uu.call(this,t,"not-in",e)||this}function mu(t,e){return hu.call(this,t,"in",e)||this}function wu(t,e){return cu.call(this,t,"array-contains",e)||this}function bu(t){return(t.before?"b":"a")+":"+t.position.map(Xo).join(",")}function Eu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.V()?Jr.i(Jr.D(s.referenceValue),n.key):Qo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Iu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!zo(t.position[n],e.position[n]))return!1;return!0}var Tu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Au(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Nu=(ku.prototype.reset=function(){this.Tn=0},ku.prototype.An=function(){this.Tn=this.mn},ku.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.yn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);0<i&&Cr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this._n.Pn(this.fn,i,function(){return e.In=Date.now(),t()}),this.Tn*=this.wn,this.Tn<this.dn&&(this.Tn=this.dn),this.Tn>this.mn&&(this.Tn=this.mn)},ku.prototype.pn=function(){null!==this.En&&(this.En.gn(),this.En=null)},ku.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},ku.prototype.yn=function(){return(Math.random()-.5)*this.Tn},ku),Ru=(Su.prototype.catch=function(t){return this.next(void 0,t)},Su.prototype.next=function(r,i){var o=this;return this.Sn&&Br(),this.Sn=!0,this.bn?this.error?this.Cn(i,this.error):this.Dn(r,this.result):new Su(function(e,n){o.Vn=function(t){o.Dn(r,t).next(e,n)},o.vn=function(t){o.Cn(i,t).next(e,n)}})},Su.prototype.Fn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Su.prototype.Nn=function(t){try{var e=t();return e instanceof Su?e:Su.resolve(e)}catch(t){return Su.reject(t)}},Su.prototype.Dn=function(t,e){return t?this.Nn(function(){return t(e)}):Su.resolve(e)},Su.prototype.Cn=function(t,e){return t?this.Nn(function(){return t(e)}):Su.reject(e)},Su.resolve=function(n){return new Su(function(t,e){t(n)})},Su.reject=function(n){return new Su(function(t,e){e(n)})},Su.$n=function(t){return new Su(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Su.xn=function(t){for(var n=Su.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Su.resolve(t):e()})}(r[e]);return n},Su.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$n(i)},Su);function Su(t){var e=this;this.Vn=null,this.vn=null,this.result=void 0,this.error=void 0,this.bn=!1,this.Sn=!1,t(function(t){e.bn=!0,e.result=t,e.Vn&&e.Vn(t)},function(t){e.bn=!0,e.error=t,e.vn&&e.vn(t)})}function ku(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}function Du(t){return"IndexedDbTransactionError"===t.name}function Lu(){return"undefined"!=typeof document?document:null}var Ou=(_u.qn=function(t,e,n,r,i){var o=new _u(t,e,Date.now()+n,r,i);return o.start(n),o},_u.prototype.start=function(t){var e=this;this.Un=setTimeout(function(){return e.Bn()},t)},_u.prototype.gn=function(){return this.Bn()},_u.prototype.cancel=function(t){null!==this.Un&&(this.clearTimeout(),this.Ln.reject(new Or(Lr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},_u.prototype.Bn=function(){var e=this;this.kn.Qn(function(){return null!==e.Un?(e.clearTimeout(),e.op().then(function(t){return e.Ln.resolve(t)})):Promise.resolve()})},_u.prototype.clearTimeout=function(){null!==this.Un&&(this.Mn(this),clearTimeout(this.Un),this.Un=null)},_u),Pu=(Object.defineProperty(Vu.prototype,"Zn",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),Vu.prototype.Qn=function(t){this.enqueue(t)},Vu.prototype.ts=function(t){this.es(),this.ns(t)},Vu.prototype.ss=function(){var t;this.Gn||(this.Gn=!0,(t=Lu())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xn))},Vu.prototype.enqueue=function(t){return this.es(),this.Gn?new Promise(function(t){}):this.ns(t)},Vu.prototype.rs=function(t){var e=this;this.Wn.push(t),this.Qn(function(){return e.os()})},Vu.prototype.os=function(){return w(this,void 0,void 0,function(){var e,n=this;return b(this,function(t){switch(t.label){case 0:if(0===this.Wn.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Wn[0]()];case 2:return t.sent(),this.Wn.shift(),this.Jn.reset(),[3,4];case 3:if(!Du(e=t.sent()))throw e;return Cr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Wn.length&&this.Jn.Rn(function(){return n.os()}),t.label=5;case 5:return[2]}})})},Vu.prototype.ns=function(t){var r=this,e=this.jn.then(function(){return r.Hn=!0,t().catch(function(t){throw r.Kn=t,r.Hn=!1,jr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Hn=!1,t})});return this.jn=e},Vu.prototype.Pn=function(t,e,n){var r=this;this.es(),-1<this.Yn.indexOf(t)&&(e=0);var i=Ou.qn(this,t,e,n,function(t){return r.us(t)});return this.zn.push(i),i},Vu.prototype.es=function(){this.Kn&&Br()},Vu.prototype.cs=function(){},Vu.prototype.hs=function(){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return[4,e=this.jn];case 1:t.sent(),t.label=2;case 2:if(e!==this.jn)return[3,0];t.label=3;case 3:return[2]}})})},Vu.prototype.ls=function(t){for(var e=0,n=this.zn;e<n.length;e++)if(n[e].fn===t)return!0;return!1},Vu.prototype._s=function(r){var i=this;return this.hs().then(function(){i.zn.sort(function(t,e){return t.On-e.On});for(var t=0,e=i.zn;t<e.length;t++){var n=e[t];if(n.gn(),"all"!==r&&n.fn===r)break}return i.hs()})},Vu.prototype.fs=function(t){this.Yn.push(t)},Vu.prototype.us=function(t){var e=this.zn.indexOf(t);this.zn.splice(e,1)},Vu);function Vu(){var e=this;this.jn=Promise.resolve(),this.Wn=[],this.Gn=!1,this.zn=[],this.Kn=null,this.Hn=!1,this.Yn=[],this.Jn=new Nu(this,"async_queue_retry"),this.Xn=function(){var t=Lu();t&&Cr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Jn.pn()};var t=Lu();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Xn)}function _u(t,e,n,r,i){this.kn=t,this.fn=e,this.On=n,this.op=r,this.Mn=i,this.Ln=new Au,this.then=this.Ln.promise.then.bind(this.Ln.promise),this.Ln.promise.catch(function(t){})}function Uu(t,e){if(jr("AsyncQueue",e+": "+t),Du(t))return new Or(Lr.UNAVAILABLE,e+": "+t);throw t}function Cu(){this.ds=void 0,this.listeners=[]}function ju(){this.ws=new Ui(za,Ga),this.onlineState="Unknown",this.Ts=new Set}function Mu(u,h){return w(this,void 0,void 0,function(){var e,n,r,i,o,s,a;return b(this,function(t){switch(t.label){case 0:if(e=u,n=h.query,r=!1,(i=e.ws.get(n))||(r=!0,i=new Cu),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Es(n)];case 2:return o.ds=t.sent(),[3,4];case 3:return s=t.sent(),a=Uu(s,"Initialization of query '"+Wa(h.query)+"' failed"),[2,void h.onError(a)];case 4:return e.ws.set(n,i),i.listeners.push(h),h.Is(e.onlineState),i.ds&&h.As(i.ds)&&Bu(e),[2]}})})}function xu(s,a){return w(this,void 0,void 0,function(){var e,n,r,i,o;return b(this,function(t){return e=s,n=a.query,r=!1,(i=e.ws.get(n))&&0<=(o=i.listeners.indexOf(a))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.ws.delete(n),e.Rs(n))]:[2]})})}function Bu(t){t.Ts.forEach(function(t){t.next()})}var Fu=(zu.prototype.As=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new To(t.query,t.docs,t.Bt,e,t.Qt,t.fromCache,t.jt,!0)}var o=!1;return this.Ps?this.gs(t)&&(this.ys.next(t),o=!0):this.Vs(t,this.onlineState)&&(this.vs(t),o=!0),this.ps=t,o},zu.prototype.onError=function(t){this.ys.error(t)},zu.prototype.Is=function(t){this.onlineState=t;var e=!1;return this.ps&&!this.Ps&&this.Vs(this.ps,t)&&(this.vs(this.ps),e=!0),e},zu.prototype.Vs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.bs&&n||t.docs.m()&&"Offline"!==e)},zu.prototype.gs=function(t){if(0<t.docChanges.length)return!0;var e=this.ps&&this.ps.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},zu.prototype.vs=function(t){t=To.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Ps=!0,this.ys.next(t)},zu),qu=(Gu.prototype.Ss=function(){return null!=this.uid},Gu.prototype.Cs=function(){return this.Ss()?"uid:"+this.uid:"anonymous-user"},Gu.prototype.isEqual=function(t){return t.uid===this.uid},Gu);function Gu(t){this.uid=t}function zu(t,e,n){this.query=t,this.ys=e,this.Ps=!1,this.ps=null,this.onlineState="Unknown",this.options=n||{}}qu.UNAUTHENTICATED=new qu(null),qu.Ds=new qu("google-credentials-uid"),qu.Fs=new qu("first-party-uid");var Wu=(Qu.prototype.$s=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Qu.prototype.next=function(){var t=++this.previousValue;return this.xs&&this.xs(t),t},Qu);function Qu(t,e){var n=this;this.previousValue=t,e&&(e.Ns=function(t){return n.$s(t)},this.xs=function(t){return e.ks(t)})}Wu.Os=-1;var Hu=(sh.prototype.Ms=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},sh.prototype.Ls=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},sh.prototype.qs=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},sh),Xu=(oh.prototype.js=function(t){},oh.prototype.Ws=function(t,e,n){},oh.prototype.Gs=function(t){return this.Us.Ms(t),this.Bs[t]||"not-current"},oh.prototype.zs=function(t,e,n){this.Bs[t]=e},oh.prototype.Ks=function(t){this.Us.Ls(t)},oh.prototype.Hs=function(t){return this.Us.activeTargetIds.has(t)},oh.prototype.Ys=function(t){delete this.Bs[t]},oh.prototype.Js=function(){return this.Us.activeTargetIds},oh.prototype.Xs=function(t){return this.Us.activeTargetIds.has(t)},oh.prototype.start=function(){return this.Us=new Hu,Promise.resolve()},oh.prototype.Zs=function(t,e,n){},oh.prototype.ti=function(t){},oh.prototype.ei=function(){},oh.prototype.ks=function(t){},oh),Yu=(ih.prototype.si=function(t,e,n){for(var r=n.ii,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Ks(o,e,r[i]))}return e},ih.prototype.ri=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Js(i,e,e,this.ni))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=Js(u,e,o,this.ni))}return e},ih.prototype.oi=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ri(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},ih.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},wo())},ih.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ai(this.mutations,t.mutations,Zs)&&Ai(this.baseMutations,t.baseMutations,Zs)},ih),Ku=(rh.from=function(t,e,n){Fr(t.mutations.length===n.length);for(var r=go,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new rh(t,e,n,r)},rh),Ju=(nh.prototype._i=function(e,n){var r=this;return this.hi.fi(e,n).next(function(t){return r.di(e,n,t)})},nh.prototype.di=function(t,r,i){return this.ai.wi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ri(r,t);return t})},nh.prototype.mi=function(t,e,i){var o=fo;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ri(t,e);o=o.rt(t,e)}),o},nh.prototype.Ti=function(e,t){var n=this;return this.ai.getEntries(e,t).next(function(t){return n.Ei(e,t)})},nh.prototype.Ei=function(r,i){var o=this;return this.hi.Ii(r,i).next(function(t){var e=o.mi(r,i,t),n=fo;return e.forEach(function(t,e){e=e||new Ra(t,ji.min()),n=n.rt(t,e)}),n})},nh.prototype.Ai=function(t,e,n){return r=e,Jr.N(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Ri(t,e.path):ja(e)?this.yi(t,e,n):this.Pi(t,e,n);var r},nh.prototype.Ri=function(t,e){return this._i(t,new Jr(e)).next(function(t){var e=yo;return t instanceof Na&&(e=e.rt(t.key,t)),e})},nh.prototype.yi=function(i,o,s){var a=this,u=o.collectionGroup,h=yo;return this.li.pi(i,u).next(function(t){return Ru.forEach(t,function(t){var e,n,r=(e=o,n=t.child(u),new ka(n,null,e.rn.slice(),e.filters.slice(),e.limit,e.on,e.startAt,e.endAt));return a.Pi(i,r,s).next(function(t){t.forEach(function(t,e){h=h.rt(t,e)})})}).next(function(){return h})})},nh.prototype.Pi=function(e,n,t){var c,l,r=this;return this.ai.Ai(e,n,t).next(function(t){return c=t,r.hi.gi(e,n)}).next(function(t){return l=t,r.Vi(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],a=s.key,u=c.get(a),h=Js(s,u,u,r.ni);c=h instanceof Na?c.rt(a,h):c.remove(a)}})}).next(function(){return c.forEach(function(t,e){Qa(n,e)||(c=c.remove(t))}),c})},nh.prototype.Vi=function(t,e,n){for(var r=wo(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof ra&&null===n.get(u.key)&&(r=r.add(u.key))}var h=n;return this.ai.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Na&&(h=h.rt(t,e))}),h})},nh),Zu=(eh.Si=function(t,e){for(var n=wo(),r=wo(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new eh(t,e.fromCache,n,r)},eh),$u=(th.Ni=function(t){return new th(t,th.$i,th.xi)},th);function th(t,e,n){this.Ci=t,this.Di=e,this.Fi=n}function eh(t,e,n,r){this.targetId=t,this.fromCache=e,this.vi=n,this.bi=r}function nh(t,e,n){this.ai=t,this.hi=e,this.li=n}function rh(t,e,n,r){this.batch=t,this.ui=e,this.ii=n,this.ci=r}function ih(t,e,n,r){this.batchId=t,this.ni=e,this.baseMutations=n,this.mutations=r}function oh(){this.Us=new Hu,this.Bs={},this.Qs=null,this.Ns=null}function sh(){this.activeTargetIds=bo}$u.ki=-1,$u.Oi=1048576,$u.Mi=41943040,$u.$i=10,$u.xi=1e3,$u.Li=new $u($u.Mi,$u.$i,$u.xi),$u.qi=new $u($u.ki,0,0);var ah=(dh.prototype.Bi=function(t,e){return this.Ui.add(e),Ru.resolve()},dh.prototype.pi=function(t,e){return Ru.resolve(this.Ui.getEntries(e))},dh),uh=(ph.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new co(Xr.i),i=!r.has(n);return this.index[e]=r.add(n),i},ph.prototype.has=function(t){var e=t._(),n=t.h(),r=this.index[e];return r&&r.has(n)},ph.prototype.getEntries=function(t){return(this.index[t]||new co(Xr.i)).A()},ph),hh=(fh.prototype.next=function(){return this.Qi+=2,this.Qi},fh.ji=function(){return new fh(0)},fh.Wi=function(){return new fh(-1)},fh),ch=(lh.prototype.ir=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.rr(t,n.zi)})},lh);function lh(t,e,n){this.persistence=t,this.Gi=e,this.zi=new ro(Ti),this.Ki=new Ui(Hi,Xi),this.Hi=ji.min(),this.hi=t.Yi(n),this.Ji=t.Xi(),this.Zi=t.tr(),this.er=new Ju(this.Ji,this.hi,this.persistence.nr()),this.Gi.sr(this.er)}function fh(t){this.Qi=t}function ph(){this.index={}}function dh(){this.Ui=new uh}function vh(t,c){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,n,i,o,s,r,a,u=c.batch.keys(),h=l.Ji.ur({cr:!0});return e=l,n=t,o=h,s=(i=c).batch,r=s.keys(),a=Ru.resolve(),r.forEach(function(r){a=a.next(function(){return o.wi(n,r)}).next(function(t){var e=t,n=i.ci.get(r);Fr(null!==n),(!e||e.version.L(n)<0)&&(e=s.si(r,e,i))&&o.ar(e,i.ui)})}),a.next(function(){return e.hi.hr(n,s)}).next(function(){return h.apply(t)}).next(function(){return l.hi.lr(t)}).next(function(){return l.er.Ti(t,u)})})}function yh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Zi._r(t)})}function gh(t,s){var c=t,l=s.et,f=c.zi;return c.persistence.runTransaction("Apply remote event","readwrite-primary",function(u){var i=c.Ji.ur({cr:!0});f=c.zi;var h=[];s.zt.forEach(function(t,e){var n,r,i,o,s,a=f.get(e);a&&(h.push(c.Zi.dr(u,t.ne,e).next(function(){return c.Zi.wr(u,t.te,e)})),0<(n=t.resumeToken).M()&&(r=a.st(n,l).nt(u.mr),f=f.rt(e,r),i=a,s=t,Fr(0<(o=r).resumeToken.M()),(0===i.resumeToken.M()||3e8<=o.et.J()-i.et.J()||0<s.te.size+s.ee.size+s.ne.size)&&h.push(c.Zi.Tr(u,r))))});var t,o=fo,n=wo();return s.Ht.forEach(function(t,e){n=n.add(t)}),h.push(i.getEntries(u,n).next(function(r){s.Ht.forEach(function(t,e){var n=r.get(t);e instanceof Ra&&e.version.isEqual(ji.min())?(i.Er(t,l),o=o.rt(t,e)):null==n||0<e.version.L(n.version)||0===e.version.L(n.version)&&n.hasPendingWrites?(i.ar(e,l),o=o.rt(t,e)):Cr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),s.Yt.has(t)&&h.push(c.persistence.Ar.Ir(u,t))})})),l.isEqual(ji.min())||(t=c.Zi._r(u).next(function(t){return c.Zi.Rr(u,u.mr,l)}),h.push(t)),Ru.$n(h).next(function(){return i.apply(u)}).next(function(){return c.er.Ei(u,o)})}).then(function(t){return c.zi=f,t})}function mh(o,s,a){return w(this,void 0,void 0,function(){var e,n,r,i;return b(this,function(t){switch(t.label){case 0:n=(e=o).zi.get(s),r=a?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),a?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Ar.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Du(i=t.sent()))throw i;return Cr("LocalStore","Failed to update sequence numbers for target "+s+": "+i),[3,5];case 5:return e.zi=e.zi.remove(s),e.Ki.delete(n.target),[2]}})})}function wh(t,s,a){var u=t,h=ji.min(),c=wo();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=xa(s),(void 0!==(o=(i=t).Ki.get(r))?Ru.resolve(i.zi.get(o)):i.Zi.Pr(n,r)).next(function(t){if(t)return h=t.lastLimboFreeSnapshotVersion,u.Zi.pr(e,t.targetId).next(function(t){c=t})}).next(function(){return u.Gi.Ai(e,s,a?h:ji.min(),a?c:wo())}).next(function(t){return{documents:t,gr:c}});var t,n,r,i,o})}function bh(e){return w(this,void 0,void 0,function(){return b(this,function(t){if(e.code!==Lr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Cr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Eh(t,e){this.user=e,this.type="OAuth",this.Ur={},this.Ur.Authorization="Bearer "+t}function Ih(t,e,n,r,i){var o=this;this.Bo=t,this.Qo=e,this.kn=n,this.jo={},this.Wo=[],this.Go=new Map,this.zo=new Set,this.Ko=[],this.Ho=i,this.Ho.Yo(function(t){n.Qn(function(){return w(o,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return rc(this)?(Cr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return(e=n).zo.add(4),[4,Yh(e)];case 1:return t.sent(),e.Jo.set("Unknown"),e.zo.delete(4),[4,Xh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Jo=new Ch(n,r)}var Th,Ah,Nh,Rh=(Hh.prototype.m=function(){return this.Vr.m()},Hh.prototype.Cr=function(t,e){var n=new Sh(t,e);this.Vr=this.Vr.add(n),this.br=this.br.add(n)},Hh.prototype.Dr=function(t,e){var n=this;t.forEach(function(t){return n.Cr(t,e)})},Hh.prototype.Fr=function(t,e){this.Nr(new Sh(t,e))},Hh.prototype.$r=function(t,e){var n=this;t.forEach(function(t){return n.Fr(t,e)})},Hh.prototype.kr=function(t){var e=this,n=new Jr(new Xr([])),r=new Sh(n,t),i=new Sh(n,t+1),o=[];return this.br.Ft([r,i],function(t){e.Nr(t),o.push(t.key)}),o},Hh.prototype.Or=function(){var e=this;this.Vr.forEach(function(t){return e.Nr(t)})},Hh.prototype.Nr=function(t){this.Vr=this.Vr.delete(t),this.br=this.br.delete(t)},Hh.prototype.Mr=function(t){var e=new Jr(new Xr([])),n=new Sh(e,t),r=new Sh(e,t+1),i=wo();return this.br.Ft([n,r],function(t){i=i.add(t.key)}),i},Hh.prototype.Lr=function(t){var e=new Sh(t,0),n=this.Vr.$t(e);return null!==n&&t.isEqual(n.key)},Hh),Sh=(Qh.vr=function(t,e){return Jr.i(t.key,e.key)||Ti(t.qr,e.qr)},Qh.Sr=function(t,e){return Ti(t.qr,e.qr)||Jr.i(t.key,e.key)},Qh),kh=(Wh.prototype.getToken=function(){return Promise.resolve(null)},Wh.prototype.Qr=function(){},Wh.prototype.jr=function(t){(this.Br=t)(qu.UNAUTHENTICATED)},Wh.prototype.Wr=function(){this.Br=null},Wh),Dh=(zh.prototype.getToken=function(){var e=this,n=this.Kr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Kr!==n?(Cr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Fr("string"==typeof t.accessToken),new Eh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},zh.prototype.Qr=function(){this.forceRefresh=!0},zh.prototype.jr=function(t){this.Br=t,this.zr&&t(this.currentUser)},zh.prototype.Wr=function(){this.auth&&this.auth.removeAuthTokenListener(this.Gr),this.Gr=null,this.Br=null},zh.prototype.Hr=function(){var t=this.auth&&this.auth.getUid();return Fr(null===t||"string"==typeof t),new qu(t)},zh),Lh=(Object.defineProperty(Gh.prototype,"Ur",{get:function(){var t={"X-Goog-AuthUser":this.Jr},e=this.Yr.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Gh),Oh=(qh.prototype.getToken=function(){return Promise.resolve(new Lh(this.Yr,this.Jr))},qh.prototype.jr=function(t){t(qu.Fs)},qh.prototype.Wr=function(){},qh.prototype.Qr=function(){},qh),Ph=(Fh.prototype.io=function(){return 1===this.state||2===this.state||4===this.state},Fh.prototype.ro=function(){return 2===this.state},Fh.prototype.start=function(){3!==this.state?this.auth():this.oo()},Fh.prototype.stop=function(){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.io()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Fh.prototype.uo=function(){this.state=0,this.Jn.reset()},Fh.prototype.co=function(){var t=this;this.ro()&&null===this.so&&(this.so=this._n.Pn(this.Xr,6e4,function(){return t.ao()}))},Fh.prototype.ho=function(t){this.lo(),this.stream.send(t)},Fh.prototype.ao=function(){return w(this,void 0,void 0,function(){return b(this,function(t){return this.ro()?[2,this.close(0)]:[2]})})},Fh.prototype.lo=function(){this.so&&(this.so.cancel(),this.so=null)},Fh.prototype.close=function(e,n){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.lo(),this.Jn.cancel(),this.no++,3!==e?this.Jn.reset():n&&n.code===Lr.RESOURCE_EXHAUSTED?(jr(n.toString()),jr("Using maximum backoff delay to prevent overloading the backend."),this.Jn.An()):n&&n.code===Lr.UNAUTHENTICATED&&this.eo.Qr(),null!==this.stream&&(this._o(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.fo(n)];case 1:return t.sent(),[2]}})})},Fh.prototype._o=function(){},Fh.prototype.auth=function(){var n=this;this.state=1;var t=this.do(this.no),e=this.no;this.eo.getToken().then(function(t){n.no===e&&n.wo(t)},function(e){t(function(){var t=new Or(Lr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.mo(t)})})},Fh.prototype.wo=function(t){var e=this,n=this.do(this.no);this.stream=this.To(t),this.stream.Eo(function(){n(function(){return e.state=2,e.listener.Eo()})}),this.stream.fo(function(t){n(function(){return e.mo(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Fh.prototype.oo=function(){var t=this;this.state=4,this.Jn.Rn(function(){return w(t,void 0,void 0,function(){return b(this,function(t){return this.state=0,this.start(),[2]})})})},Fh.prototype.mo=function(t){return Cr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Fh.prototype.do=function(e){var n=this;return function(t){n._n.Qn(function(){return n.no===e?t():(Cr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Fh),Vh=(o(Bh,Nh=Ph),Bh.prototype.To=function(t){return this.Zr.Io("Listen",t)},Bh.prototype.onMessage=function(t){this.Jn.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Br(),a=e.targetChange.targetIds||[],u=(i=e.targetChange.resumeToken,t.Be?(Fr(void 0===i||"string"==typeof i),Ni.fromBase64String(i||"")):(Fr(void 0===i||i instanceof Uint8Array),Ni.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=h&&(r=void 0===(n=h).code?Lr.UNKNOWN:no(n.code),new Or(r,n.message||"")),l=new ko(s,a,u,c||null)}else if("documentChange"in e){e.documentChange;var f=e.documentChange;f.document,f.document.name,f.document.updateTime;var p=vs(t,f.document.name),d=fs(f.document.updateTime),v=new va({mapValue:{fields:f.document.fields}}),y=new Na(p,d,v,{}),g=f.targetIds||[],m=f.removedTargetIds||[];l=new Ro(g,m,y.key,y)}else if("documentDelete"in e){e.documentDelete;var w=e.documentDelete;w.document;var b=vs(t,w.document),E=w.readTime?fs(w.readTime):ji.min(),I=new Ra(b,E),T=w.removedTargetIds||[];l=new Ro([],T,I.key,I)}else if("documentRemove"in e){e.documentRemove;var A=e.documentRemove;A.document;var N=vs(t,A.document),R=A.removedTargetIds||[];l=new Ro([],R,N,null)}else{if(!("filter"in e))return Br();e.filter;var S=e.filter;S.targetId;var k=S.count||0,D=new Ki(k),L=S.targetId;l=new So(L,D)}return l}(this.serializer,t),n=function(t){if(!("targetChange"in t))return ji.min();var e=t.targetChange;return(!e.targetIds||!e.targetIds.length)&&e.readTime?fs(e.readTime):ji.min()}(t);return this.listener.Ao(e,n)},Bh.prototype.Ro=function(t){var e,n,r,i,o={};o.database=gs(this.serializer),o.addTarget=(e=this.serializer,i=(n=t).target,(r=Yi(i)?{documents:{documents:[ys(e,i.path)]}}:{query:bs(e,i)}).targetId=n.targetId,0<n.resumeToken.M()&&(r.resumeToken=ls(e,n.resumeToken)),r);var s,a,u=(this.serializer,s=t,null==(a=function(){switch(s.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Br()}}())?null:{"goog-listen-tags":a});u&&(o.labels=u),this.ho(o)},Bh.prototype.yo=function(t){var e={};e.database=gs(this.serializer),e.removeTarget=t,this.ho(e)},Bh),_h=(o(xh,Ah=Ph),Object.defineProperty(xh.prototype,"po",{get:function(){return this.Po},enumerable:!1,configurable:!0}),xh.prototype.start=function(){this.Po=!1,this.lastStreamToken=void 0,Ah.prototype.start.call(this)},xh.prototype._o=function(){this.Po&&this.Vo([])},xh.prototype.To=function(t){return this.Zr.Io("Write",t)},xh.prototype.onMessage=function(t){if(Fr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Po){this.Jn.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Fr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?fs(t.updateTime):fs(e);n.isEqual(ji.min())&&(n=fs(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new Ws(n,r)}(t,i)})):[]),n=fs(t.commitTime);return this.listener.vo(n,e)}var r,i;return Fr(!t.writeResults||0===t.writeResults.length),this.Po=!0,this.listener.bo()},xh.prototype.So=function(){var t={};t.database=gs(this.serializer),this.ho(t)},xh.prototype.Vo=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return ws(e.serializer,t)})};this.ho(n)},xh),Uh=(o(Mh,Th=function(){}),Mh.prototype.Do=function(){if(this.Co)throw new Or(Lr.FAILED_PRECONDITION,"The client has already been terminated.")},Mh.prototype.Fo=function(e,n,r){var i=this;return this.Do(),this.credentials.getToken().then(function(t){return i.Zr.Fo(e,n,r,t)}).catch(function(t){throw t.code===Lr.UNAUTHENTICATED&&i.credentials.Qr(),t})},Mh.prototype.No=function(e,n,r){var i=this;return this.Do(),this.credentials.getToken().then(function(t){return i.Zr.No(e,n,r,t)}).catch(function(t){throw t.code===Lr.UNAUTHENTICATED&&i.credentials.Qr(),t})},Mh.prototype.terminate=function(){this.Co=!1},Mh),Ch=(jh.prototype.Oo=function(){var t=this;0===this.$o&&(this.Mo("Unknown"),this.xo=this.kn.Pn("online_state_timeout",1e4,function(){return t.xo=null,t.Lo("Backend didn't respond within 10 seconds."),t.Mo("Offline"),Promise.resolve()}))},jh.prototype.qo=function(t){"Online"===this.state?this.Mo("Unknown"):(this.$o++,1<=this.$o&&(this.Uo(),this.Lo("Connection failed 1 times. Most recent error: "+t.toString()),this.Mo("Offline")))},jh.prototype.set=function(t){this.Uo(),this.$o=0,"Online"===t&&(this.ko=!1),this.Mo(t)},jh.prototype.Mo=function(t){t!==this.state&&(this.state=t,this.Qs(t))},jh.prototype.Lo=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.ko?(jr(e),this.ko=!1):Cr("OnlineStateTracker",e)},jh.prototype.Uo=function(){null!==this.xo&&(this.xo.cancel(),this.xo=null)},jh);function jh(t,e){this.kn=t,this.Qs=e,this.state="Unknown",this.$o=0,this.xo=null,this.ko=!0}function Mh(t,e,n){var r=this;return(r=Th.call(this)||this).credentials=t,r.Zr=e,r.serializer=n,r.Co=!1,r}function xh(t,e,n,r,i){var o=this;return(o=Ah.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Po=!1,o}function Bh(t,e,n,r,i){var o=this;return(o=Nh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Fh(t,e,n,r,i,o){this._n=t,this.Xr=n,this.Zr=r,this.eo=i,this.listener=o,this.state=0,this.no=0,this.so=null,this.stream=null,this.Jn=new Nu(t,e)}function qh(t,e){this.Yr=t,this.Jr=e}function Gh(t,e){this.Yr=t,this.Jr=e,this.type="FirstParty",this.user=qu.Fs}function zh(t){var e=this;this.Gr=null,this.currentUser=qu.UNAUTHENTICATED,this.zr=!1,this.Kr=0,this.Br=null,this.forceRefresh=!1,this.Gr=function(){e.Kr++,e.currentUser=e.Hr(),e.zr=!0,e.Br&&e.Br(e.currentUser)},this.Kr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Gr):(this.Gr(null),t.get().then(function(t){e.auth=t,e.Gr&&e.auth.addAuthTokenListener(e.Gr)},function(){}))}function Wh(){this.Br=null}function Qh(t,e){this.key=t,this.qr=e}function Hh(){this.Vr=new co(Sh.vr),this.br=new co(Sh.Sr)}function Xh(r){return w(this,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:if(!rc(r))return[3,4];e=0,n=r.Ko,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Yh(r){return w(this,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:e=0,n=r.Ko,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Kh(n){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return e=n,Cr("RemoteStore","RemoteStore shutting down."),e.zo.add(5),[4,Yh(e)];case 1:return t.sent(),e.Ho.ei(),e.Jo.set("Unknown"),[2]}})})}function Jh(t,e){var n=t;n.Go.has(e.targetId)||(n.Go.set(e.targetId,e),nc(n)?ec(n):lc(n).ro()&&$h(n,e))}function Zh(t,e){var n=t,r=lc(n);n.Go.delete(e),r.ro()&&tc(n,e),0===n.Go.size&&(r.ro()?r.co():rc(n)&&n.Jo.set("Unknown"))}function $h(t,e){t.Xo.Ee(e.targetId),lc(t).Ro(e)}function tc(t,e){t.Xo.Ee(e),lc(t).yo(e)}function ec(e){e.Xo=new Lo({qe:function(t){return e.jo.qe(t)},Ue:function(t){return e.Go.get(t)||null}}),lc(e).start(),e.Jo.Oo()}function nc(t){return rc(t)&&!lc(t).io()&&0<t.Go.size}function rc(t){return 0===t.zo.size}function ic(t){t.Xo=void 0}function oc(a,u,h){return w(this,void 0,void 0,function(){var n,o,s;return b(this,function(t){switch(t.label){case 0:if(a.Jo.set("Online"),!(u instanceof ko&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return w(this,void 0,void 0,function(){var e,n,r,i;return b(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Go.has(i)?[4,o.jo.Zo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Go.delete(i),o.Xo.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(a,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Cr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,sc(a,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Ro?a.Xo.Ve(u):u instanceof So?a.Xo.$e(u):a.Xo.Se(u),h.isEqual(ji.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,yh(a.Bo)];case 8:return o=t.sent(),0<=h.L(o)?[4,(i=h,(e=(r=a).Xo.Oe(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.M()&&((n=r.Go.get(e))&&r.Go.set(e,n.st(t.resumeToken,i)))}),e.Kt.forEach(function(t){var e,n=r.Go.get(t);n&&(r.Go.set(t,n.st(Ni.q,n.et)),tc(r,t),e=new $i(n.target,t,1,n.sequenceNumber),$h(r,e))}),r.jo.tu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Cr("RemoteStore","Failed to raise snapshot:",s=t.sent()),[4,sc(a,s)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function sc(n,r,i){return w(this,void 0,void 0,function(){var e=this;return b(this,function(t){switch(t.label){case 0:if(!Du(r))throw r;return n.zo.add(1),[4,Yh(n)];case 1:return t.sent(),n.Jo.set("Offline"),i=i||function(){return yh(n.Bo)},n.kn.rs(function(){return w(e,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return Cr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.zo.delete(1),[4,Xh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function ac(e,n){return n().catch(function(t){return sc(e,t,n)})}function uc(h){return w(this,void 0,void 0,function(){var i,o,s,a,u;return b(this,function(t){switch(t.label){case 0:o=fc(i=h),s=0<i.Wo.length?i.Wo[i.Wo.length-1].batchId:-1,t.label=1;case 1:if(!(rc(i)&&i.Wo.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Bo,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.hi.yr(t,n)}))];case 3:return null===(a=t.sent())?(0===i.Wo.length&&o.co(),[3,7]):(s=a.batchId,function(t,e){t.Wo.push(e);var n=fc(t);n.ro()&&n.po&&n.Vo(e.mutations)}(i,a),[3,6]);case 4:return u=t.sent(),[4,sc(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return hc(i)&&cc(i),[2]}var e,n,r})})}function hc(t){return rc(t)&&!fc(t).io()&&0<t.Wo.length}function cc(t){fc(t).start()}function lc(n){var t,e,r,i,o=this;return n.su||(n.su=(t=n.Qo,e=n.kn,r={Eo:function(n){return w(this,void 0,void 0,function(){return b(this,function(t){return n.Go.forEach(function(t,e){$h(n,t)}),[2]})})}.bind(null,n),fo:function(e,n){return w(this,void 0,void 0,function(){return b(this,function(t){return ic(e),nc(e)?(e.Jo.qo(n),ec(e)):e.Jo.set("Unknown"),[2]})})}.bind(null,n),Ao:oc.bind(null,n)},(i=t).Do(),new Vh(e,i.Zr,i.credentials,i.serializer,r)),n.Ko.push(function(e){return w(o,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return e?(n.su.uo(),nc(n)?ec(n):n.Jo.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.su.stop()];case 2:t.sent(),ic(n),t.label=3;case 3:return[2]}})})})),n.su}function fc(n){var t,e,r,i,o=this;return n.iu||(n.iu=(t=n.Qo,e=n.kn,r={Eo:function(e){return w(this,void 0,void 0,function(){return b(this,function(t){return fc(e).So(),[2]})})}.bind(null,n),fo:function(e,n){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return n&&fc(e).po?[4,function(r,i){return w(this,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:return eo(n=i.code)&&n!==Lr.ABORTED?(e=r.Wo.shift(),fc(r).uo(),[4,ac(r,function(){return r.jo.nu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,uc(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return hc(e)&&cc(e),[2]}})})}.bind(null,n),bo:function(o){return w(this,void 0,void 0,function(){var e,n,r,i;return b(this,function(t){for(e=fc(o),n=0,r=o.Wo;n<r.length;n++)i=r[n],e.Vo(i.mutations);return[2]})})}.bind(null,n),vo:function(r,i,o){return w(this,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:return e=r.Wo.shift(),n=Ku.from(e,i,o),[4,ac(r,function(){return r.jo.eu(n)})];case 1:return t.sent(),[4,uc(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},(i=t).Do(),new _h(e,i.Zr,i.credentials,i.serializer,r)),n.Ko.push(function(e){return w(o,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return e?(n.iu.uo(),[4,uc(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.iu.stop()];case 3:t.sent(),0<n.Wo.length&&(Cr("RemoteStore","Stopping write stream with "+n.Wo.length+" pending writes"),n.Wo=[]),t.label=4;case 4:return[2]}})})})),n.iu}function pc(t,e,n){this.query=t,this.targetId=e,this.view=n}var dc=function(t){this.key=t},vc=function(t){this.key=t},yc=(Object.defineProperty(bc.prototype,"hu",{get:function(){return this.ru},enumerable:!1,configurable:!0}),bc.prototype.lu=function(t,e){var a=this,u=e?e._u:new Io,h=e?e.au:this.au,c=e?e.Qt:this.Qt,l=h,f=!1,p=Va(this.query)&&h.size===this.query.limit?h.last():null,d=_a(this.query)&&h.size===this.query.limit?h.first():null;if(t.at(function(t,e){var n=h.get(t),r=(r=e instanceof Na?e:null)&&(Qa(a.query,r)?r:null),i=!!n&&a.Qt.has(n.key),o=!!r&&(r.Ye||a.Qt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),s=!0):a.fu(n,r)||(u.track({type:2,doc:r}),s=!0,(p&&0<a.cu(r,p)||d&&a.cu(r,d)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),s=!0):n&&!r&&(u.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=r?(l=l.add(r),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),Va(this.query)||_a(this.query))for(;l.size>this.query.limit;){var n=Va(this.query)?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{au:l,_u:u,du:f,Qt:c}},bc.prototype.fu=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},bc.prototype.wu=function(t,e,n){var o=this,r=this.au;this.au=t.au,this.Qt=t.Qt;var i=t._u.Ut();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.cu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Br()}}var r,i}),this.mu(n);var s=e?this.Tu():[],a=0===this.uu.size&&this.Zt?1:0,u=a!==this.ou;return this.ou=a,0!==i.length||u?{snapshot:new To(this.query,t.au,r,i,t.Qt,0==a,u,!1),Eu:s}:{Eu:s}},bc.prototype.Is=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.wu({au:this.au,_u:new Io,Qt:this.Qt,du:!1},!1)):{Eu:[]}},bc.prototype.Iu=function(t){return!this.ru.has(t)&&!!this.au.has(t)&&!this.au.get(t).Ye},bc.prototype.mu=function(t){var e=this;t&&(t.te.forEach(function(t){return e.ru=e.ru.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.ru=e.ru.delete(t)}),this.Zt=t.Zt)},bc.prototype.Tu=function(){var e=this;if(!this.Zt)return[];var n=this.uu;this.uu=wo(),this.au.forEach(function(t){e.Iu(t.key)&&(e.uu=e.uu.add(t.key))});var r=[];return n.forEach(function(t){e.uu.has(t)||r.push(new vc(t))}),this.uu.forEach(function(t){n.has(t)||r.push(new dc(t))}),r},bc.prototype.Au=function(t){this.ru=t.gr,this.uu=wo();var e=this.lu(t.documents);return this.wu(e,!0)},bc.prototype.Ru=function(){return To.Gt(this.query,this.au,this.Qt,0===this.ou)},bc),gc=function(t){this.key=t,this.yu=!1},mc=(Object.defineProperty(wc.prototype,"Mu",{get:function(){return!0===this.Ou},enumerable:!1,configurable:!0}),wc);function wc(t,e,n,r,i,o){this.Bo=t,this.Pu=e,this.pu=n,this.gu=r,this.currentUser=i,this.Vu=o,this.vu={},this.bu=new Ui(za,Ga),this.Su=new Map,this.Cu=[],this.Du=new ro(Jr.i),this.Fu=new Map,this.Nu=new Rh,this.$u={},this.xu=new Map,this.ku=hh.Wi(),this.onlineState="Unknown",this.Ou=void 0}function bc(t,e){this.query=t,this.ru=e,this.ou=null,this.Zt=!1,this.uu=wo(),this.Qt=wo(),this.cu=Ha(t),this.au=new Eo(this.cu)}function Ec(l,f){return w(this,void 0,void 0,function(){var o,s,a,u,h,c;return b(this,function(t){switch(t.label){case 0:return(n=l).Pu.jo.tu=Tc.bind(null,n),n.Pu.jo.qe=function(t,e){var n=t,r=n.Fu.get(e);if(r&&r.yu)return wo().add(r.key);var i=wo(),o=n.Su.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++){var u=a[s],h=n.bu.get(u);i=i.xt(h.view.hu)}return i}.bind(null,n),n.Pu.jo.Zo=function(a,u,h){return w(this,void 0,void 0,function(){var e,n,r,i,o,s;return b(this,function(t){switch(t.label){case 0:return(e=a).gu.zs(u,"rejected",h),n=e.Fu.get(u),(r=n&&n.key)?(i=(i=new ro(Jr.i)).rt(r,new Ra(r,ji.min())),o=wo().add(r),s=new Ao(ji.min(),new Map,new co(Ti),i,o),[4,Tc(e,s)]):[3,2];case 1:return t.sent(),e.Du=e.Du.remove(r),e.Fu.delete(u),Lc(e),[3,4];case 2:return[4,mh(e.Bo,u,!1).then(function(){return Sc(e,u,h)}).catch(bh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,n),n.vu.Ao=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.ws.get(a);if(u){for(var h=0,c=u.listeners;h<c.length;h++)c[h].As(s)&&(r=!0);u.ds=s}}r&&Bu(n)}.bind(null,n.pu),n.vu.Lu=function(t,e,n){var r=t,i=r.ws.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.ws.delete(e)}.bind(null,n.pu),(u=(o=n).bu.get(f))?(s=u.targetId,o.gu.Gs(s),a=u.view.Ru(),[3,4]):[3,1];case 1:return[4,(e=o.Bo,r=xa(f),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Zi.Pr(e,r).next(function(t){return t?(n=t,Ru.resolve(n)):i.Zi.qu(e).next(function(t){return n=new $i(r,t,0,e.mr),i.Zi.Uu(e,n).next(function(){return n})})})}).then(function(t){var e=i.zi.get(t.targetId);return(null===e||0<t.et.L(e.et))&&(i.zi=i.zi.rt(t.targetId,t),i.Ki.set(r,t.targetId)),t}))];case 2:return h=t.sent(),c=o.gu.Gs(h.targetId),s=h.targetId,[4,function(a,u,h,c){return w(this,void 0,void 0,function(){var e,n,r,i,o,s;return b(this,function(t){switch(t.label){case 0:return a.Bu=function(t,e,n){return function(i,o,s,a){return w(this,void 0,void 0,function(){var n,e,r;return b(this,function(t){switch(t.label){case 0:return(n=o.view.lu(s)).du?[4,wh(i.Bo,o.query,!1).then(function(t){var e=t.documents;return o.view.lu(e,n)})]:[3,2];case 1:n=t.sent(),t.label=2;case 2:return e=a&&a.zt.get(o.targetId),r=o.view.wu(n,i.Mu,e),[2,(Dc(i,o.targetId,r.Eu),r.snapshot)]}})})}(a,t,e,n)},[4,wh(a.Bo,u,!0)];case 1:return e=t.sent(),n=new yc(u,e.gr),r=n.lu(e.documents),i=No.Xt(h,c&&"Offline"!==a.onlineState),o=n.wu(r,a.Mu,i),Dc(a,h,o.Eu),s=new pc(u,h,n),a.bu.set(u,s),a.Su.has(h)?a.Su.get(h).push(u):a.Su.set(h,[u]),[2,o.snapshot]}})})}(o,f,s,"current"===c)];case 3:a=t.sent(),o.Mu&&Jh(o.Pu,h),t.label=4;case 4:return[2,a]}var e,r,i,n})})}function Ic(y,g,m){return w(this,void 0,void 0,function(){var u,p,d,v;return b(this,function(t){switch(t.label){case 0:(a=y).Pu.jo.eu=function(i,o){return w(this,void 0,void 0,function(){var e,n,r;return b(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,vh(e.Bo,o)];case 2:return r=t.sent(),Rc(e,n,null),Nc(e,n),e.gu.Ws(n,"acknowledged"),[4,Oc(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,bh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,a),a.Pu.jo.nu=function(s,a,u){return w(this,void 0,void 0,function(){var n,o;return b(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Bo,r=a,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.hi.Wu(e,r).next(function(t){return Fr(null!==t),n=t.keys(),i.hi.hr(e,t)}).next(function(){return i.hi.lr(e)}).next(function(){return i.er.Ti(e,n)})}))];case 2:return o=t.sent(),Rc(n,a,u),Nc(n,a),n.gu.Ws(a,"rejected",u),[4,Oc(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,bh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,a),u=a,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(o=u.Bo,h=g,l=o,f=Ci.now(),s=h.reduce(function(t,e){return t.add(e.key)},wo()),l.persistence.runTransaction("Locally write mutations","readwrite",function(u){return l.er.Ti(u,s).next(function(t){c=t;for(var a,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(a=o,e=c.get(o.key),a instanceof ua?function(t){for(var e=null,n=0,r=a.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Na?t.field(i.field):void 0,s=Ns(i.transform,o||null);null!=s&&(e=null==e?(new ya).set(i.field,s):e.set(i.field,s))}return e?e.Je():null}(e):null);null!=s&&n.push(new ra(o.key,s,function a(t){var u=[];return Gr(t.fields||{},function(t,e){var n=new Kr([t]);if(rs(e)){var r=a(e.mapValue).fields;if(0===r.length)u.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];u.push(n.child(s))}}else u.push(n)}),new Gs(u)}(s.proto.mapValue),Qs.exists(!0)))}return l.hi.Qu(u,f,n,h)})}).then(function(t){var e=t.oi(c);return{batchId:t.batchId,ju:e}}))];case 2:return p=t.sent(),u.gu.js(p.batchId),e=u,n=p.batchId,r=m,i=(i=(i=e.$u[e.currentUser.Cs()])||new ro(Ti)).rt(n,r),e.$u[e.currentUser.Cs()]=i,[4,Oc(u,p.ju)];case 3:return t.sent(),[4,uc(u.Pu)];case 4:return t.sent(),[3,6];case 5:return d=t.sent(),v=Uu(d,"Failed to persist write"),m.reject(v),[3,6];case 6:return[2]}var e,n,r,i,o,h,c,l,f,s,a})})}function Tc(n,i){return w(this,void 0,void 0,function(){var r,e;return b(this,function(t){switch(t.label){case 0:r=n,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,gh(r.Bo,i)];case 2:return e=t.sent(),i.zt.forEach(function(t,e){var n=r.Fu.get(e);n&&(Fr(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?n.yu=!0:0<t.ee.size?Fr(n.yu):0<t.ne.size&&(Fr(n.yu),n.yu=!1))}),[4,Oc(r,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,bh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Ac(t,r,e){var i,n=t;(n.Mu&&0===e||!n.Mu&&1===e)&&(i=[],n.bu.forEach(function(t,e){var n=e.view.Is(r);n.snapshot&&i.push(n.snapshot)}),function(t,i){var e=t;e.onlineState=i;var o=!1;e.ws.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Is(i)&&(o=!0)}),o&&Bu(e)}(n.pu,r),i.length&&n.vu.Ao(i),n.onlineState=r,n.Mu&&n.gu.ti(r))}function Nc(t,e){(t.xu.get(e)||[]).forEach(function(t){t.resolve()}),t.xu.delete(e)}function Rc(t,e,n){var r,i=t,o=i.$u[i.currentUser.Cs()];o&&((r=o.get(e))&&(n?r.reject(n):r.resolve(),o=o.remove(e)),i.$u[i.currentUser.Cs()]=o)}function Sc(e,t,n){void 0===n&&(n=null),e.gu.Ks(t);for(var r=0,i=e.Su.get(t);r<i.length;r++){var o=i[r];e.bu.delete(o),n&&e.vu.Lu(o,n)}e.Su.delete(t),e.Mu&&e.Nu.kr(t).forEach(function(t){e.Nu.Lr(t)||kc(e,t)})}function kc(t,e){var n=t.Du.get(e);null!==n&&(Zh(t.Pu,n),t.Du=t.Du.remove(e),t.Fu.delete(n),Lc(t))}function Dc(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var a=s[o];a instanceof dc?(t.Nu.Cr(a.key,e),r=t,i=void 0,i=a.key,r.Du.get(i)||(Cr("SyncEngine","New document in limbo: "+i),r.Cu.push(i),Lc(r))):a instanceof vc?(Cr("SyncEngine","Document no longer in limbo: "+a.key),t.Nu.Fr(a.key,e),t.Nu.Lr(a.key)||kc(t,a.key)):Br()}}function Lc(t){for(;0<t.Cu.length&&t.Du.size<t.Vu;){var e=t.Cu.shift(),n=t.ku.next();t.Fu.set(n,new gc(e)),t.Du=t.Du.rt(e,n),Jh(t.Pu,new $i(xa(Pa(e.path)),n,2,Wu.Os))}}function Oc(n,s,a){return w(this,void 0,void 0,function(){var r,i,o,e;return b(this,function(t){switch(t.label){case 0:return i=[],o=[],e=[],(r=n).bu.m()?[3,3]:(r.bu.forEach(function(t,n){e.push(r.Bu(n,s,a).then(function(t){var e;t&&(r.Mu&&r.gu.zs(n.targetId,t.fromCache?"not-current":"current"),i.push(t),e=Zu.Si(n.targetId,t),o.push(e))}))}),[4,Promise.all(e)]);case 1:return t.sent(),r.vu.Ao(i),[4,function(c,l){return w(this,void 0,void 0,function(){var r,e,n,i,o,s,a,u,h;return b(this,function(t){switch(t.label){case 0:r=c,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Ru.forEach(l,function(e){return Ru.forEach(e.vi,function(t){return r.persistence.Ar.Cr(n,e.targetId,t)}).next(function(){return Ru.forEach(e.bi,function(t){return r.persistence.Ar.Fr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Du(e=t.sent()))throw e;return Cr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=l;n<i.length;n++)o=i[n],s=o.targetId,o.fromCache||(a=r.zi.get(s),u=a.et,h=a.it(u),r.zi=r.zi.rt(s,h));return[2]}})})}(r.Bo,o)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Pc(i,o){return w(this,void 0,void 0,function(){var n,r;return b(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Cr("SyncEngine","User change. New user:",o.Cs()),[4,function(i,o){return w(this,void 0,void 0,function(){var e,n,m,r;return b(this,function(t){switch(t.label){case 0:return n=(e=i).hi,m=e.er,[4,e.persistence.runTransaction("Handle user change","readonly",function(y){var g;return e.hi.zu(y).next(function(t){return g=t,n=e.persistence.Yi(o),m=new Ju(e.Ji,n,e.persistence.nr()),n.zu(y)}).next(function(t){for(var e=[],n=[],r=wo(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++)var h=u[a],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var v=d[p];r=r.add(v.key)}}return m.Ti(y,r).next(function(t){return{Ku:t,Hu:e,Yu:n}})})})];case 1:return r=t.sent(),[2,(e.hi=n,e.er=m,e.Gi.sr(e.er),r)]}})})}(n.Bo,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).xu.forEach(function(t){t.forEach(function(t){t.reject(new Or(Lr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.xu.clear(),n.gu.Zs(o,r.Hu,r.Yu),[4,Oc(n,r.Ku)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}var Vc,_c=(xc.prototype.sr=function(t){this.Ju=t},xc.prototype.Ai=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.V())||i.isEqual(ji.min())?this.Xu(e,r):this.Ju.Ti(e,o).next(function(t){var n=s.Zu(r,t);return(Va(r)||_a(r))&&s.du(r.on,n,o,i)?s.Xu(e,r):(Ur()<=a.DEBUG&&Cr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Wa(r)),s.Ju.Ai(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},xc.prototype.Zu=function(n,t){var r=new co(Ha(n));return t.forEach(function(t,e){e instanceof Na&&Qa(n,e)&&(r=r.add(e))}),r},xc.prototype.du=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.L(r))},xc.prototype.Xu=function(t,e){return Ur()<=a.DEBUG&&Cr("IndexFreeQueryEngine","Using full collection scan to execute query:",Wa(e)),this.Ju.Ai(t,e,ji.min())},xc),Uc=(Mc.prototype.nc=function(t){return Ru.resolve(0===this.hi.length)},Mc.prototype.Qu=function(t,e,n,r){var i=this.tc;this.tc++,0<this.hi.length&&this.hi[this.hi.length-1];var o=new Yu(i,e,n,r);this.hi.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.ec=this.ec.add(new Sh(u.key,i)),this.li.Bi(t,u.key.path.h())}return Ru.resolve(o)},Mc.prototype.Wu=function(t,e){return Ru.resolve(this.sc(e))},Mc.prototype.yr=function(t,e){var n=e+1,r=this.ic(n),i=r<0?0:r;return Ru.resolve(this.hi.length>i?this.hi[i]:null)},Mc.prototype.Gu=function(){return Ru.resolve(0===this.hi.length?-1:this.tc-1)},Mc.prototype.zu=function(t){return Ru.resolve(this.hi.slice())},Mc.prototype.fi=function(t,e){var n=this,r=new Sh(e,0),i=new Sh(e,Number.POSITIVE_INFINITY),o=[];return this.ec.Ft([r,i],function(t){var e=n.sc(t.qr);o.push(e)}),Ru.resolve(o)},Mc.prototype.Ii=function(t,e){var r=this,i=new co(Ti);return e.forEach(function(t){var e=new Sh(t,0),n=new Sh(t,Number.POSITIVE_INFINITY);r.ec.Ft([e,n],function(t){i=i.add(t.qr)})}),Ru.resolve(this.rc(i))},Mc.prototype.gi=function(t,e){var n=e.path,r=n.length+1,i=n;Jr.N(i)||(i=i.child(""));var o=new Sh(new Jr(i),0),s=new co(Ti);return this.ec.Nt(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(s=s.add(t.qr)),!0)},o),Ru.resolve(this.rc(s))},Mc.prototype.rc=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.sc(t);null!==e&&r.push(e)}),r},Mc.prototype.hr=function(n,r){var i=this;Fr(0===this.oc(r.batchId,"removed")),this.hi.shift();var o=this.ec;return Ru.forEach(r.mutations,function(t){var e=new Sh(t.key,r.batchId);return o=o.delete(e),i.Ar.uc(n,t.key)}).next(function(){i.ec=o})},Mc.prototype.cc=function(t){},Mc.prototype.Lr=function(t,e){var n=new Sh(e,0),r=this.ec.$t(n);return Ru.resolve(e.isEqual(r&&r.key))},Mc.prototype.lr=function(t){return this.hi.length,Ru.resolve()},Mc.prototype.oc=function(t,e){return this.ic(t)},Mc.prototype.ic=function(t){return 0===this.hi.length?0:t-this.hi[0].batchId},Mc.prototype.sc=function(t){var e=this.ic(t);return e<0||e>=this.hi.length?null:this.hi[e]},Mc),Cc=(jc.prototype.ar=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ac(e);return this.docs=this.docs.rt(r,{hc:e,size:s,readTime:n}),this.size+=s-o,this.li.Bi(t,r.path.h())},jc.prototype.Er=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},jc.prototype.wi=function(t,e){var n=this.docs.get(e);return Ru.resolve(n?n.hc:null)},jc.prototype.getEntries=function(t,e){var n=this,r=fo;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.hc:null)}),Ru.resolve(r)},jc.prototype.Ai=function(t,e,n){for(var r=yo,i=new Jr(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Et(),a=s.key,u=s.value,h=u.hc,c=u.readTime;if(!e.path.T(a.path))break;c.L(n)<=0||h instanceof Na&&Qa(e,h)&&(r=r.rt(h.key,h))}return Ru.resolve(r)},jc.prototype.lc=function(t,e){return Ru.forEach(this.docs,function(t){return e(t)})},jc.prototype.ur=function(t){return new jc._c(this)},jc.prototype.fc=function(t){return Ru.resolve(this.size)},jc);function jc(t,e){this.li=t,this.ac=e,this.docs=new ro(Jr.i),this.size=0}function Mc(t,e){this.li=t,this.Ar=e,this.hi=[],this.tc=1,this.ec=new co(Sh.vr)}function xc(){}function Bc(t){var e=this;return(e=Vc.call(this)||this).Ic=t,e}function Fc(){this.ju=new Ui(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.dc=!1}Cc._c=(Object.defineProperty(Fc.prototype,"readTime",{get:function(){return this.wc},set:function(t){this.wc=t},enumerable:!1,configurable:!0}),Fc.prototype.ar=function(t,e){this.mc(),this.readTime=e,this.ju.set(t.key,t)},Fc.prototype.Er=function(t,e){this.mc(),e&&(this.readTime=e),this.ju.set(t,null)},Fc.prototype.wi=function(t,e){this.mc();var n=this.ju.get(e);return void 0!==n?Ru.resolve(n):this.Tc(t,e)},Fc.prototype.getEntries=function(t,e){return this.Ec(t,e)},Fc.prototype.apply=function(t){return this.mc(),this.dc=!0,this.wu(t)},Fc.prototype.mc=function(){},o(Bc,Vc=Fc),Bc.prototype.wu=function(n){var r=this,i=[];return this.ju.forEach(function(t,e){e?i.push(r.Ic.ar(n,e,r.readTime)):r.Ic.Er(t)}),Ru.$n(i)},Bc.prototype.Tc=function(t,e){return this.Ic.wi(t,e)},Bc.prototype.Ec=function(t,e){return this.Ic.getEntries(t,e)},Bc);var qc,Gc,zc=(ul.prototype.Ce=function(t,n){return this.Ac.forEach(function(t,e){return n(e)}),Ru.resolve()},ul.prototype._r=function(t){return Ru.resolve(this.lastRemoteSnapshotVersion)},ul.prototype.gc=function(t){return Ru.resolve(this.Rc)},ul.prototype.qu=function(t){return this.highestTargetId=this.Pc.next(),Ru.resolve(this.highestTargetId)},ul.prototype.Rr=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Rc&&(this.Rc=e),Ru.resolve()},ul.prototype.Vc=function(t){this.Ac.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Pc=new hh(e),this.highestTargetId=e),t.sequenceNumber>this.Rc&&(this.Rc=t.sequenceNumber)},ul.prototype.Uu=function(t,e){return this.Vc(e),this.targetCount+=1,Ru.resolve()},ul.prototype.Tr=function(t,e){return this.Vc(e),Ru.resolve()},ul.prototype.vc=function(t,e){return this.Ac.delete(e.target),this.yc.kr(e.targetId),--this.targetCount,Ru.resolve()},ul.prototype.bc=function(n,r,i){var o=this,s=0,a=[];return this.Ac.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Ac.delete(t),a.push(o.Sc(n,e.targetId)),s++)}),Ru.$n(a).next(function(){return s})},ul.prototype.Cc=function(t){return Ru.resolve(this.targetCount)},ul.prototype.Pr=function(t,e){var n=this.Ac.get(e)||null;return Ru.resolve(n)},ul.prototype.wr=function(t,e,n){return this.yc.Dr(e,n),Ru.resolve()},ul.prototype.dr=function(e,t,n){this.yc.$r(t,n);var r=this.persistence.Ar,i=[];return r&&t.forEach(function(t){i.push(r.uc(e,t))}),Ru.$n(i)},ul.prototype.Sc=function(t,e){return this.yc.kr(e),Ru.resolve()},ul.prototype.pr=function(t,e){var n=this.yc.Mr(e);return Ru.resolve(n)},ul.prototype.Lr=function(t,e){return Ru.resolve(this.yc.Lr(e))},ul),Wc=(al.prototype.start=function(){return Promise.resolve()},al.prototype.ei=function(){return this.Nc=!1,Promise.resolve()},Object.defineProperty(al.prototype,"xc",{get:function(){return this.Nc},enumerable:!1,configurable:!0}),al.prototype.kc=function(){},al.prototype.Oc=function(){},al.prototype.nr=function(){return this.li},al.prototype.Yi=function(t){var e=this.Dc[t.Cs()];return e||(e=new Uc(this.li,this.Ar),this.Dc[t.Cs()]=e),e},al.prototype.tr=function(){return this.Zi},al.prototype.Xi=function(){return this.ai},al.prototype.runTransaction=function(t,e,n){var r=this;Cr("MemoryPersistence","Starting transaction:",t);var i=new Qc(this.Fc.next());return this.Ar.Mc(),n(i).next(function(t){return r.Ar.Lc(i).next(function(){return t})}).Fn().then(function(t){return i.qc(),t})},al.prototype.Uc=function(e,n){return Ru.xn(Object.values(this.Dc).map(function(t){return function(){return t.Lr(e,n)}}))},al),Qc=(sl.prototype.Qc=function(t){this.Bc.push(t)},sl.prototype.qc=function(){this.Bc.forEach(function(t){return t()})},o(ol,Gc=sl),ol),Hc=(il.Gc=function(t){return new il(t)},Object.defineProperty(il.prototype,"zc",{get:function(){if(this.Wc)return this.Wc;throw Br()},enumerable:!1,configurable:!0}),il.prototype.Cr=function(t,e,n){return this.jc.Cr(n,e),this.zc.delete(n.toString()),Ru.resolve()},il.prototype.Fr=function(t,e,n){return this.jc.Fr(n,e),this.zc.add(n.toString()),Ru.resolve()},il.prototype.uc=function(t,e){return this.zc.add(e.toString()),Ru.resolve()},il.prototype.removeTarget=function(t,e){var n=this;this.jc.kr(e.targetId).forEach(function(t){return n.zc.add(t.toString())});var r=this.persistence.tr();return r.pr(t,e.targetId).next(function(t){t.forEach(function(t){return n.zc.add(t.toString())})}).next(function(){return r.vc(t,e)})},il.prototype.Mc=function(){this.Wc=new Set},il.prototype.Lc=function(n){var r=this,i=this.persistence.Xi().ur();return Ru.forEach(this.zc,function(t){var e=Jr.C(t);return r.Kc(n,e).next(function(t){t||i.Er(e)})}).next(function(){return r.Wc=null,i.apply(n)})},il.prototype.Ir=function(t,e){var n=this;return this.Kc(t,e).next(function(t){t?n.zc.delete(e.toString()):n.zc.add(e.toString())})},il.prototype.$c=function(t){return 0},il.prototype.Kc=function(t,e){var n=this;return Ru.xn([function(){return Ru.resolve(n.jc.Lr(e))},function(){return n.persistence.tr().Lr(t,e)},function(){return n.persistence.Uc(t,e)}])},il),Xc=(rl.prototype.Eo=function(t){this.Jc=t},rl.prototype.fo=function(t){this.Xc=t},rl.prototype.onMessage=function(t){this.Zc=t},rl.prototype.close=function(){this.Yc()},rl.prototype.send=function(t){this.Hc(t)},rl.prototype.ta=function(){this.Jc()},rl.prototype.ea=function(t){this.Xc(t)},rl.prototype.na=function(t){this.Zc(t)},rl),Yc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Kc=(nl.prototype.Fo=function(e,t,n,r){var i=this.oa(e,t);Cr("RestConnection","Sending: ",i,n);var o={};return this.ua(o,r),this.ca(e,i,o,n).then(function(t){return Cr("RestConnection","Received: ",t),t},function(t){throw Mr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},nl.prototype.No=function(t,e,n,r){return this.Fo(t,e,n,r)},nl.prototype.ua=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.21.1-2020822235757",t["Content-Type"]="text/plain",e)for(var n in e.Ur)e.Ur.hasOwnProperty(n)&&(t[n]=e.Ur[n])},nl.prototype.oa=function(t,e){var n=Yc[t];return this.ia+"/v1/"+e+":"+n},o(el,qc=nl),el.prototype.ca=function(u,e,n,r){return new Promise(function(o,s){var a=new Rr;a.listenOnce(Ar.COMPLETE,function(){try{switch(a.getLastErrorCode()){case Tr.NO_ERROR:var t=a.getResponseJson();Cr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Tr.TIMEOUT:Cr("Connection",'RPC "'+u+'" timed out'),s(new Or(Lr.DEADLINE_EXCEEDED,"Request time out"));break;case Tr.HTTP_ERROR:var e,n,r=a.getStatus();Cr("Connection",'RPC "'+u+'" failed with status:',r,"response text:",a.getResponseText()),0<r?(e=a.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Lr).indexOf(i)?i:Lr.UNKNOWN,s(new Or(n,e.message))):s(new Or(Lr.UNKNOWN,"Server responded with status "+a.getStatus())):s(new Or(Lr.UNAVAILABLE,"Connection failed."));break;default:Br()}}finally{Cr("Connection",'RPC "'+u+'" completed.')}var i});var t=JSON.stringify(r);a.send(e,"POST",t,n,15)})},el.prototype.Io=function(t,e){var n,r,i=[this.ia,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Ir(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.B.projectId+"/databases/"+this.B.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.ua(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=v().indexOf("Electron/")||(0<=(r=v()).indexOf("MSIE ")||0<=r.indexOf("Trident/"))||0<=v().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=i.join("");Cr("Connection","Creating WebChannel: "+a,s);function u(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}var h=o.createWebChannel(a,s),c=!1,l=!1,f=new Xc({Hc:function(t){l?Cr("Connection","Not sending because WebChannel is closed:",t):(c||(Cr("Connection","Opening WebChannel transport."),h.open(),c=!0),Cr("Connection","WebChannel sending:",t),h.send(t))},Yc:function(){return h.close()}});return u(Nr.EventType.OPEN,function(){l||Cr("Connection","WebChannel transport opened.")}),u(Nr.EventType.CLOSE,function(){l||(l=!0,Cr("Connection","WebChannel transport closed"),f.ea())}),u(Nr.EventType.ERROR,function(t){l||(l=!0,Mr("Connection","WebChannel transport errored:",t),f.ea(new Or(Lr.UNAVAILABLE,"The operation could not be completed")))}),u(Nr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;l||(Fr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Cr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Ji[i];if(void 0!==t)return no(t)}(),s=r.message,void 0===o&&(o=Lr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),l=!0,f.ea(new Or(o,s)),h.close()):(Cr("Connection","WebChannel received:",n),f.na(n)))}),setTimeout(function(){f.ta()},0),f},el),Jc=(tl.prototype.Yo=function(t){this.fa.push(t)},tl.prototype.ei=function(){window.removeEventListener("online",this.aa),window.removeEventListener("offline",this.la)},tl.prototype.da=function(){window.addEventListener("online",this.aa),window.addEventListener("offline",this.la)},tl.prototype.ha=function(){Cr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.fa;t<e.length;t++)(0,e[t])(0)},tl.prototype._a=function(){Cr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.fa;t<e.length;t++)(0,e[t])(1)},tl.wa=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},tl),Zc=($c.prototype.Yo=function(t){},$c.prototype.ei=function(){},$c);function $c(){}function tl(){var t=this;this.aa=function(){return t.ha()},this.la=function(){return t._a()},this.fa=[],this.da()}function el(t){var e=this;return(e=qc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function nl(t){this.sa=t,this.B=t.B;var e=t.ssl?"https":"http";this.ia=e+"://"+t.host,this.ra="projects/"+this.B.projectId+"/databases/"+this.B.database+"/documents"}function rl(t){this.Hc=t.Hc,this.Yc=t.Yc}function il(t){this.persistence=t,this.jc=new Rh,this.Wc=null}function ol(t){var e=this;return(e=Gc.call(this)||this).mr=t,e}function sl(){this.Bc=[]}function al(t){var e=this;this.Dc={},this.Fc=new Wu(0),this.Nc=!1,this.Nc=!0,this.Ar=t(this),this.Zi=new zc(this),this.li=new ah,this.ai=new Cc(this.li,function(t){return e.Ar.$c(t)})}function ul(t){this.persistence=t,this.Ac=new Ui(Hi,Xi),this.lastRemoteSnapshotVersion=ji.min(),this.highestTargetId=0,this.Rc=0,this.yc=new Rh,this.targetCount=0,this.Pc=hh.ji()}function hl(t){return new ss(t,!0)}var cl,ll,fl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",pl=(Nl.prototype.initialize=function(e){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.gu=this.ma(e),this.persistence=this.Ta(e),[4,this.persistence.start()];case 1:return t.sent(),this.Ea=this.Ia(e),this.Bo=this.Aa(e),[2]}})})},Nl.prototype.Ia=function(t){return null},Nl.prototype.Aa=function(t){return e=this.persistence,n=new _c,r=t.Ra,new ch(e,n,r);var e,n,r},Nl.prototype.Ta=function(t){if(t.persistenceSettings.ya)throw new Or(Lr.FAILED_PRECONDITION,fl);return new Wc(Hc.Gc)},Nl.prototype.ma=function(t){return new Xu},Nl.prototype.terminate=function(){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.Ea&&this.Ea.stop(),[4,this.gu.ei()];case 1:return t.sent(),[4,this.persistence.ei()];case 2:return t.sent(),[2]}})})},Nl.prototype.clearPersistence=function(t,e){throw new Or(Lr.FAILED_PRECONDITION,fl)},Nl),dl=(Al.prototype.initialize=function(n,r){return w(this,void 0,void 0,function(){var e=this;return b(this,function(t){switch(t.label){case 0:return this.Bo?[3,2]:(this.Bo=n.Bo,this.gu=n.gu,this.Qo=this.Pa(r),this.Pu=this.pa(r),this.pu=this.ga(r),this.Va=this.va(r),this.gu.Qs=function(t){return Ac(e.Va,t,1)},this.Pu.jo.ba=Pc.bind(null,this.Va),[4,function(n,r){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return e=n,r?(e.zo.delete(2),[4,Xh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.zo.add(2),[4,Yh(e)]);case 3:t.sent(),e.Jo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Pu,this.Va.Mu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Al.prototype.ga=function(t){return new ju},Al.prototype.Pa=function(t){var e,n,r=hl(t.sa.B),i=(e=t.sa,new Kc(e));return n=t.credentials,new Uh(n,i,r)},Al.prototype.pa=function(t){var e=this,n=this.Bo,r=this.Qo,i=t.kn,o=function(t){return Ac(e.Va,t,0)},s=new(Jc.wa()?Jc:Zc);return new Ih(n,r,i,o,s)},Al.prototype.va=function(t){return e=this.Bo,n=this.Pu,r=this.pu,i=this.gu,o=t.Ra,s=t.Vu,a=!t.persistenceSettings.ya||!t.persistenceSettings.synchronizeTabs,u=new mc(e,n,r,i,o,s),a&&(u.Ou=!0),u;var e,n,r,i,o,s,a,u},Al.prototype.terminate=function(){return Kh(this.Pu)},Al),vl=(Tl.prototype.next=function(t){this.observer.next&&this.Sa(this.observer.next,t)},Tl.prototype.error=function(t){this.observer.error?this.Sa(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Tl.prototype.Ca=function(){this.muted=!0},Tl.prototype.Sa=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Tl),yl=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Or(Lr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(si("FieldPath","string",e,t[e]),0===t[e].length)throw new Or(Lr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Da=new Kr(t)},gl=(o(Il,ll=yl),Il.documentId=function(){return new Il(Kr.v().R())},Il.prototype.isEqual=function(t){if(!(t instanceof Il))throw gi("isEqual","FieldPath",1,t);return this.Da.isEqual(t.Da)},Il),ml=new RegExp("[~\\*/\\[\\]]"),wl=function(){this.Fa=this},bl=(o(El,cl=wl),El.prototype.$a=function(t){if(2!==t.xa)throw 1===t.xa?t.ka(this.Na+"() can only appear at the top level of your update data"):t.ka(this.Na+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},El.prototype.isEqual=function(t){return t instanceof El},El);function El(t){var e=this;return(e=cl.call(this)||this).Na=t,e}function Il(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ll.call(this,t)||this}function Tl(t){this.observer=t,this.muted=!1}function Al(){}function Nl(){}function Rl(t,e,n){return new tf({xa:3,Oa:e.settings.Oa,methodName:t.Na,Ma:n},e.B,e.serializer,e.ignoreUndefinedProperties)}var Sl,kl,Dl,Ll,Ol,Pl,Vl=(o(Zl,Pl=wl),Zl.prototype.$a=function(t){return new qs(t.path,new ks)},Zl.prototype.isEqual=function(t){return t instanceof Zl},Zl),_l=(o(Jl,Ol=wl),Jl.prototype.$a=function(t){var e=Rl(this,t,!0),n=this.La.map(function(t){return hf(t,e)}),r=new Ds(n);return new qs(t.path,r)},Jl.prototype.isEqual=function(t){return this===t},Jl),Ul=(o(Kl,Ll=wl),Kl.prototype.$a=function(t){var e=Rl(this,t,!0),n=this.La.map(function(t){return hf(t,e)}),r=new _s(n);return new qs(t.path,r)},Kl.prototype.isEqual=function(t){return this===t},Kl),Cl=(o(Yl,Dl=wl),Yl.prototype.$a=function(t){var e=new Ms(t.serializer,hs(t.serializer,this.qa));return new qs(t.path,e)},Yl.prototype.isEqual=function(t){return this===t},Yl),jl=(o(Xl,kl=wl),Xl.delete=function(){return ni("FieldValue.delete",arguments),new Ml(new bl("FieldValue.delete"))},Xl.serverTimestamp=function(){return ni("FieldValue.serverTimestamp",arguments),new Ml(new Vl("FieldValue.serverTimestamp"))},Xl.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ii("FieldValue.arrayUnion",arguments,1),new Ml(new _l("FieldValue.arrayUnion",t))},Xl.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ii("FieldValue.arrayRemove",arguments,1),new Ml(new Ul("FieldValue.arrayRemove",t))},Xl.increment=function(t){return si("FieldValue.increment","number",1,t),ri("FieldValue.increment",arguments,1),new Ml(new Cl("FieldValue.increment",t))},Xl),Ml=(o(Hl,Sl=jl),Hl.prototype.$a=function(t){return this.Fa.$a(t)},Hl.prototype.isEqual=function(t){return t instanceof Hl&&this.Fa.isEqual(t.Fa)},Hl),xl=(Object.defineProperty(Ql.prototype,"latitude",{get:function(){return this.Ua},enumerable:!1,configurable:!0}),Object.defineProperty(Ql.prototype,"longitude",{get:function(){return this.Ba},enumerable:!1,configurable:!0}),Ql.prototype.isEqual=function(t){return this.Ua===t.Ua&&this.Ba===t.Ba},Ql.prototype.toJSON=function(){return{latitude:this.Ua,longitude:this.Ba}},Ql.prototype.H=function(t){return Ti(this.Ua,t.Ua)||Ti(this.Ba,t.Ba)},Ql),Bl=/^__.*__$/,Fl=function(t,e,n){this.Qa=t,this.ja=e,this.Wa=n},ql=(Wl.prototype.Ga=function(t,e){var n=[];return null!==this.Qe?n.push(new ra(t,this.data,this.Qe,e)):n.push(new na(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new ua(t,this.fieldTransforms)),n},Wl),Gl=(zl.prototype.Ga=function(t,e){var n=[new ra(t,this.data,this.Qe,e)];return 0<this.fieldTransforms.length&&n.push(new ua(t,this.fieldTransforms)),n},zl);function zl(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Wl(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Ql(t,e){if(ri("GeoPoint",arguments,2),si("GeoPoint","number",1,t),si("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Or(Lr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Or(Lr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Ua=t,this.Ba=e}function Hl(t){var e=this;return(e=Sl.call(this)||this).Fa=t,e.Na=t.Na,e}function Xl(){return kl.call(this)||this}function Yl(t,e){var n=this;return(n=Dl.call(this)||this).Na=t,n.qa=e,n}function Kl(t,e){var n=this;return(n=Ll.call(this)||this).Na=t,n.La=e,n}function Jl(t,e){var n=this;return(n=Ol.call(this)||this).Na=t,n.La=e,n}function Zl(t){var e=this;return(e=Pl.call(this)||this).Na=t,e}function $l(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Br()}}var tf=(Object.defineProperty(rf.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(rf.prototype,"xa",{get:function(){return this.settings.xa},enumerable:!1,configurable:!0}),rf.prototype.Ka=function(t){return new rf(Object.assign(Object.assign({},this.settings),t),this.B,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},rf.prototype.Ha=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Ka({path:n,Ma:!1});return r.Ya(t),r},rf.prototype.Ja=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Ka({path:n,Ma:!1});return r.za(),r},rf.prototype.Xa=function(t){return this.Ka({path:void 0,Ma:!0})},rf.prototype.ka=function(t){return vf(t,this.settings.methodName,this.settings.Za||!1,this.path,this.settings.Oa)},rf.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},rf.prototype.za=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Ya(this.path.get(t))},rf.prototype.Ya=function(t){if(0===t.length)throw this.ka("Document fields must not be empty");if($l(this.xa)&&Bl.test(t))throw this.ka('Document fields cannot begin and end with "__"')},rf),ef=(nf.prototype.th=function(t,e,n,r){return void 0===r&&(r=!1),new tf({xa:t,methodName:e,Oa:n,path:Kr.p(),Ma:!1,Za:r},this.B,this.serializer,this.ignoreUndefinedProperties)},nf);function nf(t,e,n){this.B=t,this.ignoreUndefinedProperties=e,this.serializer=n||hl(t)}function rf(t,e,n,r,i,o){this.settings=t,this.B=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.za(),this.fieldTransforms=i||[],this.Qe=o||[]}function of(t,e,n,r,i,o){void 0===o&&(o={});var s=t.th(o.merge||o.mergeFields?2:0,e,n,i);ff("Data must be an object, but it was:",s,r);var a,u,h=cf(r,s);if(o.merge)a=new Gs(s.Qe),u=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof yl)d=p.Da;else{if("string"!=typeof p)throw Br();d=df(e,p,n)}if(!s.contains(d))throw new Or(Lr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");yf(c,d)||c.push(d)}a=new Gs(c),u=s.fieldTransforms.filter(function(t){return a.Ke(t.field)})}else a=null,u=s.fieldTransforms;return new ql(new va(h),a,u)}function sf(t,o,s,e){var a=t.th(1,o,s);ff("Data must be an object, but it was:",a,e);var u=[],h=new ya;Gr(e,function(t,e){var n,r=df(o,t,s),i=a.Ja(r);e instanceof wl&&e.Fa instanceof bl?u.push(r):null!=(n=hf(e,i))&&(u.push(r),h.set(r,n))});var n=new Gs(u);return new Gl(h.Je(),n,a.fieldTransforms)}function af(t,e,n,r,i,o){var s=t.th(1,e,n),a=[pf(e,r,n)],u=[i];if(o.length%2!=0)throw new Or(Lr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)a.push(pf(e,o[h])),u.push(o[h+1]);for(var c,l,f,p,d=[],v=new ya,y=a.length-1;0<=y;--y){yf(d,a[y])||(c=a[y],l=u[y],f=s.Ja(c),l instanceof wl&&l.Fa instanceof bl?d.push(c):null!=(p=hf(l,f))&&(d.push(c),v.set(c,p)))}var g=new Gs(d);return new Gl(v.Je(),g,s.fieldTransforms)}function uf(t,e,n,r){return void 0===r&&(r=!1),hf(n,t.th(r?4:3,e))}function hf(s,t){if(lf(s))return ff("Unsupported field value:",t,s),cf(s,t);if(s instanceof wl)return function(t,e){if(!$l(e.xa))throw e.ka(t.Na+"() can only be used with update() and set()");if(!e.path)throw e.ka(t.Na+"() is not currently supported inside arrays");var n=t.$a(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.Ma&&4!==t.xa)throw t.ka("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=hf(i[r],t.Xa(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return hs(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ci.fromDate(t);return{timestampValue:cs(e.serializer,n)}}if(t instanceof Ci){var r=new Ci(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:cs(e.serializer,r)}}if(t instanceof xl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Si)return{bytesValue:ls(e.serializer,t.U)};if(t instanceof Fl){var i=e.B,o=t.Qa;if(!o.isEqual(i))throw e.ka("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:ps(t.Qa||e.B,t.ja.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.ka("Unsupported field value: "+di(t))}(s,t)}function cf(t,r){var i={};return zr(t)?r.path&&0<r.path.length&&r.Qe.push(r.path):Gr(t,function(t,e){var n=hf(e,r.Ha(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function lf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ci||t instanceof xl||t instanceof Si||t instanceof Fl||t instanceof wl)}function ff(t,e,n){if(!lf(n)||!pi(n)){var r=di(n);throw"an object"===r?e.ka(t+" a custom object"):e.ka(t+" "+r)}}function pf(t,e,n){if(e instanceof yl)return e.Da;if("string"==typeof e)return df(t,e);throw vf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function df(t,e,n){try{return function(e){if(0<=e.search(ml))throw new Or(Lr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(gl.bind.apply(gl,s([void 0],e.split("."))))}catch(t){throw new Or(Lr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Da}catch(e){throw vf(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function vf(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Or(Lr.INVALID_ARGUMENT,(a+=". ")+t+u)}function yf(t,e){return t.some(function(t){return t.isEqual(e)})}var gf=(If.prototype.rh=function(r){return w(this,void 0,void 0,function(){var e,n=this;return b(this,function(t){switch(t.label){case 0:if(this.oh(),0<this.mutations.length)throw new Or(Lr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(a,u){return w(this,void 0,void 0,function(){var i,e,n,r,o,s;return b(this,function(t){switch(t.label){case 0:return e=gs((i=a).serializer)+"/documents",n={documents:u.map(function(t){return ds(i.serializer,t)})},[4,i.No("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Fr(!!e.found),e.found.name,e.found.updateTime;var n=vs(t,e.found.name),r=fs(e.found.updateTime),i=new va({mapValue:{fields:e.found.fields}});return new Na(n,r,i,{})}(e,n):"missing"in n?function(t,e){Fr(!!e.missing),Fr(!!e.readTime);var n=vs(t,e.missing),r=fs(e.readTime);return new Ra(n,r)}(e,n):Br());o.set(r.key.toString(),r)}),s=[],[2,(u.forEach(function(t){var e=o.get(t.toString());Fr(!!e),s.push(e)}),s)]}})})}(this.Qo,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Ra||t instanceof Na?n.uh(t):Br()}),e)]}})})},If.prototype.set=function(t,e){this.write(e.Ga(t,this.Ge(t))),this.ih.add(t.toString())},If.prototype.update=function(t,e){try{this.write(e.Ga(t,this.ah(t)))}catch(t){this.sh=t}this.ih.add(t.toString())},If.prototype.delete=function(t){this.write([new pa(t,this.Ge(t))]),this.ih.add(t.toString())},If.prototype.commit=function(){return w(this,void 0,void 0,function(){var e,r=this;return b(this,function(t){switch(t.label){case 0:if(this.oh(),this.sh)throw this.sh;return e=this.eh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=Jr.C(e);r.mutations.push(new da(n,r.Ge(n)))}),[4,function(i,o){return w(this,void 0,void 0,function(){var e,n,r;return b(this,function(t){switch(t.label){case 0:return n=gs((e=i).serializer)+"/documents",r={writes:o.map(function(t){return ws(e.serializer,t)})},[4,e.Fo("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Qo,this.mutations)];case 1:return t.sent(),this.nh=!0,[2]}})})},If.prototype.uh=function(t){var e;if(t instanceof Na)e=t.version;else{if(!(t instanceof Ra))throw Br();e=ji.min()}var n=this.eh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Or(Lr.ABORTED,"Document version changed between two reads.")}else this.eh.set(t.key.toString(),e)},If.prototype.Ge=function(t){var e=this.eh.get(t.toString());return!this.ih.has(t.toString())&&e?Qs.updateTime(e):Qs.He()},If.prototype.ah=function(t){var e=this.eh.get(t.toString());if(this.ih.has(t.toString())||!e)return Qs.exists(!0);if(e.isEqual(ji.min()))throw new Or(Lr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Qs.updateTime(e)},If.prototype.write=function(t){this.oh(),this.mutations=this.mutations.concat(t)},If.prototype.oh=function(){},If),mf=(Ef.prototype.run=function(){this.lh()},Ef.prototype.lh=function(){var t=this;this.Jn.Rn(function(){return w(t,void 0,void 0,function(){var e,n,r=this;return b(this,function(t){return e=new gf(this.Qo),(n=this._h(e))&&n.then(function(t){r.kn.Qn(function(){return e.commit().then(function(){r.Ln.resolve(t)}).catch(function(t){r.fh(t)})})}).catch(function(t){r.fh(t)}),[2]})})})},Ef.prototype._h=function(t){try{var e=this.updateFunction(t);return!Gi(e)&&e.catch&&e.then?e:(this.Ln.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ln.reject(t),null}},Ef.prototype.fh=function(t){var e=this;0<this.hh&&this.dh(t)?(--this.hh,this.kn.Qn(function(){return e.lh(),Promise.resolve()})):this.Ln.reject(t)},Ef.prototype.dh=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!eo(e)},Ef),wf=(bf.prototype.start=function(t,e,n,r){var i=this;this.mh(),this.sa=t;var o=new Au,s=!1;return this.credentials.jr(function(t){return s?void i.kn.rs(function(){return function(r,i){return w(this,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:return(e=r).kn.cs(),Cr("RemoteStore","RemoteStore received new credentials"),n=rc(e),e.zo.add(3),[4,Yh(e)];case 1:return t.sent(),n&&e.Jo.set("Unknown"),[4,e.jo.ba(i)];case 2:return t.sent(),e.zo.delete(3),[4,Xh(e)];case 3:return t.sent(),[2]}})})}(i.Pu,t)}):(s=!0,Cr("FirestoreClient","Initializing. user=",t.uid),i.Th(e,n,r,t,o).then(i.wh.resolve,i.wh.reject))}),this.kn.Qn(function(){return i.wh.promise}),o.promise},bf.prototype.enableNetwork=function(){var e=this;return this.mh(),this.kn.enqueue(function(){return e.persistence.Oc(!0),(t=e.Pu).zo.delete(0),Xh(t);var t})},bf.prototype.Th=function(i,o,s,a,u){return w(this,void 0,void 0,function(){var e,n,r=this;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={kn:this.kn,sa:this.sa,clientId:this.clientId,credentials:this.credentials,Ra:a,Vu:100,persistenceSettings:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.gu=i.gu,this.Bo=i.Bo,this.Ea=i.Ea,this.Qo=o.Qo,this.Pu=o.Pu,this.Va=o.Va,this.Eh=o.pu,this.Eh.Es=Ec.bind(null,this.Va),this.Eh.Rs=function(i,o){return w(this,void 0,void 0,function(){var e,n,r;return b(this,function(t){switch(t.label){case 0:return n=(e=i).bu.get(o),1<(r=e.Su.get(n.targetId)).length?[2,(e.Su.set(n.targetId,r.filter(function(t){return!Ga(t,o)})),void e.bu.delete(o))]:e.Mu?(e.gu.Ks(n.targetId),e.gu.Xs(n.targetId)?[3,2]:[4,mh(e.Bo,n.targetId,!1).then(function(){e.gu.Ys(n.targetId),Zh(e.Pu,n.targetId),Sc(e,n.targetId)}).catch(bh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Sc(e,n.targetId),[4,mh(e.Bo,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.Va),this.persistence.kc(function(){return w(r,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(n=t.sent(),u.reject(n),!this.Ih(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Th(new pl,new dl,{ya:!1},a,u))];case 4:return[2]}})})},bf.prototype.Ih=function(t){return"FirebaseError"===t.name?t.code===Lr.FAILED_PRECONDITION||t.code===Lr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},bf.prototype.mh=function(){if(this.kn.Zn)throw new Or(Lr.FAILED_PRECONDITION,"The client has already been terminated.")},bf.prototype.disableNetwork=function(){var t=this;return this.mh(),this.kn.enqueue(function(){return t.persistence.Oc(!1),function(n){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return(e=n).zo.add(0),[4,Yh(e)];case 1:return t.sent(),e.Jo.set("Offline"),[2]}})})}(t.Pu)})},bf.prototype.terminate=function(){var t=this;this.kn.ss();var r=new Au;return this.kn.ts(function(){return w(t,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Ea&&this.Ea.stop(),[4,Kh(this.Pu)];case 1:return t.sent(),[4,this.gu.ei()];case 2:return t.sent(),[4,this.persistence.ei()];case 3:return t.sent(),this.credentials.Wr(),r.resolve(),[3,5];case 4:return e=t.sent(),n=Uu(e,"Failed to shutdown persistence"),r.reject(n),[3,5];case 5:return[2]}})})}),r.promise},bf.prototype.waitForPendingWrites=function(){var t=this;this.mh();var e=new Au;return this.kn.Qn(function(){return function(a,u){return w(this,void 0,void 0,function(){var n,r,i,o,s;return b(this,function(t){switch(t.label){case 0:rc((n=a).Pu)||Cr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Bo).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.hi.Gu(t)})];case 2:return-1===(r=t.sent())?[2,void u.resolve()]:((i=n.xu.get(r)||[]).push(u),n.xu.set(r,i),[3,4]);case 3:return o=t.sent(),s=Uu(o,"Initialization of waitForPendingWrites() operation failed"),u.reject(s),[3,4];case 4:return[2]}var e})})}(t.Va,e)}),e.promise},bf.prototype.listen=function(t,e,n){var r=this;this.mh();var i=new vl(n),o=new Fu(t,i,e);return this.kn.Qn(function(){return Mu(r.Eh,o)}),function(){i.Ca(),r.kn.Qn(function(){return xu(r.Eh,o)})}},bf.prototype.Ah=function(r){return w(this,void 0,void 0,function(){var e,n=this;return b(this,function(t){switch(t.label){case 0:return this.mh(),[4,this.wh.promise];case 1:return t.sent(),e=new Au,[2,(this.kn.Qn(function(){return function(s,a,u){return w(this,void 0,void 0,function(){var r,i,o;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=a,(n=s).persistence.runTransaction("read document","readonly",function(t){return n.er._i(t,e)}))];case 1:return(r=t.sent())instanceof Na?u.resolve(r):r instanceof Ra?u.resolve(null):u.reject(new Or(Lr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=t.sent(),o=Uu(i,"Failed to get document '"+a+" from cache"),u.reject(o),[3,3];case 3:return[2]}var e,n})})}(n.Bo,r,e)}),e.promise)]}})})},bf.prototype.Rh=function(h,c){return void 0===c&&(c={}),w(this,void 0,void 0,function(){var e,u=this;return b(this,function(t){switch(t.label){case 0:return this.mh(),[4,this.wh.promise];case 1:return t.sent(),e=new Au,[2,(this.kn.Qn(function(){return n=u.Eh,r=u.kn,i=h,o=c,s=e,t=new vl({next:function(t){r.Qn(function(){return xu(n,a)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Or(Lr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Or(Lr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),a=new Fu(Pa(i.path),t,{includeMetadataChanges:!0,bs:!0}),Mu(n,a);var n,r,i,o,s,t,a}),e.promise)]}})})},bf.prototype.yh=function(r){return w(this,void 0,void 0,function(){var e,n=this;return b(this,function(t){switch(t.label){case 0:return this.mh(),[4,this.wh.promise];case 1:return t.sent(),e=new Au,[2,(this.kn.Qn(function(){return function(a,u,h){return w(this,void 0,void 0,function(){var e,n,r,i,o,s;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,wh(a,u,!0)];case 1:return e=t.sent(),n=new yc(u,e.gr),r=n.lu(e.documents),i=n.wu(r,!1),h.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Uu(o,"Failed to execute query '"+u+" against cache"),h.reject(s),[3,3];case 3:return[2]}})})}(n.Bo,r,e)}),e.promise)]}})})},bf.prototype.Ph=function(h,c){return void 0===c&&(c={}),w(this,void 0,void 0,function(){var a,u=this;return b(this,function(t){switch(t.label){case 0:return this.mh(),[4,this.wh.promise];case 1:return t.sent(),a=new Au,[2,(this.kn.Qn(function(){return e=u.Eh,n=u.kn,t=h,r=c,i=a,o=new vl({next:function(t){n.Qn(function(){return xu(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Or(Lr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Fu(t,o,{includeMetadataChanges:!0,bs:!0}),Mu(e,s);var e,n,t,r,i,o,s}),a.promise)]}})})},bf.prototype.write=function(t){var e=this;this.mh();var n=new Au;return this.kn.Qn(function(){return Ic(e.Va,t,n)}),n.promise},bf.prototype.B=function(){return this.sa.B},bf.prototype.ph=function(t){var e=this;this.mh();var r=new vl(t);return this.kn.Qn(function(){return w(e,void 0,void 0,function(){return b(this,function(t){return[2,(e=this.Eh,n=r,e.Ts.add(n),void n.next())];var e,n})})}),function(){r.Ca(),e.kn.Qn(function(){return w(e,void 0,void 0,function(){return b(this,function(t){return[2,void this.Eh.Ts.delete(r)]})})})}},Object.defineProperty(bf.prototype,"gh",{get:function(){return this.kn.Zn},enumerable:!1,configurable:!0}),bf.prototype.transaction=function(t){var e=this;this.mh();var n=new Au;return this.kn.Qn(function(){return new mf(e.kn,e.Qo,t,n).run(),Promise.resolve()}),n.promise},bf);function bf(t,e){this.credentials=t,this.kn=e,this.clientId=Ei.k(),this.wh=new Au}function Ef(t,e,n,r){this.kn=t,this.Qo=e,this.updateFunction=n,this.Ln=r,this.hh=5,this.Jn=new Nu(this.kn,"transaction_retry")}function If(t){this.Qo=t,this.eh=new Map,this.mutations=[],this.nh=!1,this.sh=null,this.ih=new Set}function Tf(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Af,Nf,Rf=(zf.prototype.Ch=function(t){switch(Go(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ko(t.integerValue||t.doubleValue);case 3:return this.Dh(t.timestampValue);case 4:return this.Fh(t);case 5:return t.stringValue;case 6:return this.Sh(Jo(t.bytesValue));case 7:return this.Nh(t.referenceValue);case 8:return this.$h(t.geoPointValue);case 9:return this.xh(t.arrayValue);case 10:return this.kh(t.mapValue);default:throw Br()}},zf.prototype.kh=function(t){var n=this,r={};return Gr(t.fields||{},function(t,e){r[t]=n.Ch(e)}),r},zf.prototype.$h=function(t){return new xl(Ko(t.latitude),Ko(t.longitude))},zf.prototype.xh=function(t){var e=this;return(t.values||[]).map(function(t){return e.Ch(t)})},zf.prototype.Fh=function(t){switch(this.Vh){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return Bo(n)?t(n):n}(t);return null==e?null:this.Ch(e);case"estimate":return this.Dh(Fo(t));default:return null}},zf.prototype.Dh=function(t){var e=Yo(t),n=new Ci(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},zf.prototype.Nh=function(t){var e=Xr.P(t);Fr(Ts(e));var n=new _i(e.get(1),e.get(3)),r=new Jr(e.u(5));return n.isEqual(this.B)||jr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.B.projectId+"/"+this.B.database+") instead."),this.bh(r)},zf),Sf=$u.ki,kf=(Gf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Gf),Df=(Object.defineProperty(qf.prototype,"zh",{get:function(){return this.Kh||(this.Kh=new ef(this.Qa,this.Gh.ignoreUndefinedProperties)),this.Kh},enumerable:!1,configurable:!0}),qf.prototype.settings=function(t){ri("Firestore.settings",arguments,1),si("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Gh),t)).merge;var e=new kf(t);if(this.Bh&&!this.Gh.isEqual(e))throw new Or(Lr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Gh=e).credentials&&(this.Wh=function(t){if(!t)return new kh;switch(t.type){case"gapi":var e=t.client;return Fr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Oh(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Or(Lr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},qf.prototype.enableNetwork=function(){return this.Uh(),this.Bh.enableNetwork()},qf.prototype.disableNetwork=function(){return this.Uh(),this.Bh.disableNetwork()},qf.prototype.enablePersistence=function(t){var e,n;if(this.Bh)throw new Or(Lr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&jr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Or(Lr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Hh(this.Oh,this.Mh,{ya:!0,cacheSizeBytes:this.Gh.cacheSizeBytes,synchronizeTabs:r,Yh:i})},qf.prototype.clearPersistence=function(){return w(this,void 0,void 0,function(){var n,e=this;return b(this,function(t){if(void 0!==this.Bh&&!this.Bh.gh)throw new Or(Lr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Au,[2,(this.qh.ts(function(){return w(e,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Oh.clearPersistence(this.Qa,this.jh)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},qf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(qf.prototype,"Jh",{get:function(){return this.Uh(),this.Bh.gh},enumerable:!1,configurable:!0}),qf.prototype.waitForPendingWrites=function(){return this.Uh(),this.Bh.waitForPendingWrites()},qf.prototype.onSnapshotsInSync=function(t){if(this.Uh(),Tf(t))return this.Bh.ph(t);si("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Bh.ph(e)},qf.prototype.Uh=function(){return this.Bh||this.Hh(new pl,new dl,{ya:!1}),this.Bh},qf.prototype.Xh=function(){return new Oi(this.Qa,this.jh,this.Gh.host,this.Gh.ssl,this.Gh.experimentalForceLongPolling)},qf.prototype.Hh=function(t,e,n){var r=this.Xh();return this.Bh=new wf(this.Wh,this.qh),this.Bh.start(r,t,e,n)},qf.Qh=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Or(Lr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Or(Lr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new _i(n)},Object.defineProperty(qf.prototype,"app",{get:function(){if(!this.Lh)throw new Or(Lr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Lh},enumerable:!1,configurable:!0}),qf.prototype.collection=function(t){return ri("Firestore.collection",arguments,1),si("Firestore.collection","non-empty string",1,t),this.Uh(),new Zf(Xr.P(t),this,null)},qf.prototype.doc=function(t){return ri("Firestore.doc",arguments,1),si("Firestore.doc","non-empty string",1,t),this.Uh(),Pf.Zh(Xr.P(t),this,null)},qf.prototype.collectionGroup=function(t){if(ri("Firestore.collectionGroup",arguments,1),si("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Or(Lr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Uh(),new Kf((e=t,new ka(Xr.p(),e)),this,null);var e},qf.prototype.runTransaction=function(e){var n=this;return ri("Firestore.runTransaction",arguments,1),si("Firestore.runTransaction","function",1,e),this.Uh().transaction(function(t){return e(new Lf(n,t))})},qf.prototype.batch=function(){return this.Uh(),new Of(this)},Object.defineProperty(qf,"logLevel",{get:function(){switch(Ur()){case a.DEBUG:return"debug";case a.ERROR:return"error";case a.SILENT:return"silent";case a.WARN:return"warn";case a.INFO:return"info";case a.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),qf.setLogLevel=function(t){ri("Firestore.setLogLevel",arguments,1),li("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Vr.setLogLevel(t)},qf.prototype.tl=function(){return this.Gh.timestampsInSnapshots},qf.prototype.el=function(){return this.Gh},qf),Lf=(Ff.prototype.get=function(t){var n=this;ri("Transaction.get",arguments,1);var r=op("Transaction.get",t,this.nl);return this.sl.rh([r.ja]).then(function(t){if(!t||1!==t.length)return Br();var e=t[0];if(e instanceof Ra)return new _f(n.nl,r.ja,null,!1,!1,r.Wa);if(e instanceof Na)return new _f(n.nl,r.ja,e,!1,!1,r.Wa);throw Br()})},Ff.prototype.set=function(t,e,n){oi("Transaction.set",arguments,2,3);var r=op("Transaction.set",t,this.nl);n=np("Transaction.set",n);var i=sp(r.Wa,e,n),o=of(this.nl.zh,"Transaction.set",r.ja,i,null!==r.Wa,n);return this.sl.set(r.ja,o),this},Ff.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof gl?(ii("Transaction.update",arguments,3),r=op("Transaction.update",t,this.nl),af(this.nl.zh,"Transaction.update",r.ja,e,n,o)):(ri("Transaction.update",arguments,2),r=op("Transaction.update",t,this.nl),sf(this.nl.zh,"Transaction.update",r.ja,e)),this.sl.update(r.ja,i),this},Ff.prototype.delete=function(t){ri("Transaction.delete",arguments,1);var e=op("Transaction.delete",t,this.nl);return this.sl.delete(e.ja),this},Ff),Of=(Bf.prototype.set=function(t,e,n){oi("WriteBatch.set",arguments,2,3),this.ol();var r=op("WriteBatch.set",t,this.nl);n=np("WriteBatch.set",n);var i=sp(r.Wa,e,n),o=of(this.nl.zh,"WriteBatch.set",r.ja,i,null!==r.Wa,n);return this.il=this.il.concat(o.Ga(r.ja,Qs.He())),this},Bf.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.ol(),i="string"==typeof e||e instanceof gl?(ii("WriteBatch.update",arguments,3),r=op("WriteBatch.update",t,this.nl),af(this.nl.zh,"WriteBatch.update",r.ja,e,n,o)):(ri("WriteBatch.update",arguments,2),r=op("WriteBatch.update",t,this.nl),sf(this.nl.zh,"WriteBatch.update",r.ja,e)),this.il=this.il.concat(i.Ga(r.ja,Qs.exists(!0))),this},Bf.prototype.delete=function(t){ri("WriteBatch.delete",arguments,1),this.ol();var e=op("WriteBatch.delete",t,this.nl);return this.il=this.il.concat(new pa(e.ja,Qs.He())),this},Bf.prototype.commit=function(){return this.ol(),this.rl=!0,0<this.il.length?this.nl.Uh().write(this.il):Promise.resolve()},Bf.prototype.ol=function(){if(this.rl)throw new Or(Lr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Bf),Pf=(o(xf,Nf=Fl),xf.Zh=function(t,e,n){if(t.length%2!=0)throw new Or(Lr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new xf(new Jr(t),e,n)},Object.defineProperty(xf.prototype,"id",{get:function(){return this.ja.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(xf.prototype,"parent",{get:function(){return new Zf(this.ja.path.h(),this.firestore,this.Wa)},enumerable:!1,configurable:!0}),Object.defineProperty(xf.prototype,"path",{get:function(){return this.ja.path.R()},enumerable:!1,configurable:!0}),xf.prototype.collection=function(t){if(ri("DocumentReference.collection",arguments,1),si("DocumentReference.collection","non-empty string",1,t),!t)throw new Or(Lr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Xr.P(t);return new Zf(this.ja.path.child(e),this.firestore,null)},xf.prototype.isEqual=function(t){if(!(t instanceof xf))throw gi("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.ja.isEqual(t.ja)&&this.Wa===t.Wa},xf.prototype.set=function(t,e){oi("DocumentReference.set",arguments,1,2),e=np("DocumentReference.set",e);var n=sp(this.Wa,t,e),r=of(this.firestore.zh,"DocumentReference.set",this.ja,n,null!==this.Wa,e);return this.Bh.write(r.Ga(this.ja,Qs.He()))},xf.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof gl?(ii("DocumentReference.update",arguments,2),af(this.firestore.zh,"DocumentReference.update",this.ja,t,e,r)):(ri("DocumentReference.update",arguments,1),sf(this.firestore.zh,"DocumentReference.update",this.ja,t)),this.Bh.write(n.Ga(this.ja,Qs.exists(!0)))},xf.prototype.delete=function(){return ri("DocumentReference.delete",arguments,0),this.Bh.write([new pa(this.ja,Qs.He())])},xf.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];oi("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||Tf(i[a])||(yi("DocumentReference.onSnapshot",s=i[a],["includeMetadataChanges"]),hi("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),a++);var u,h={includeMetadataChanges:s.includeMetadataChanges};Tf(i[a])?(u=i[a],i[a]=null===(t=u.next)||void 0===t?void 0:t.bind(u),i[a+1]=null===(e=u.error)||void 0===e?void 0:e.bind(u),i[a+2]=null===(n=u.complete)||void 0===n?void 0:n.bind(u)):(si("DocumentReference.onSnapshot","function",a,i[a]),ai("DocumentReference.onSnapshot","function",a+1,i[a+1]),ai("DocumentReference.onSnapshot","function",a+2,i[a+2]));var c={next:function(t){i[a]&&i[a](r.ul(t))},error:i[a+1],complete:i[a+2]};return this.Bh.listen(Pa(this.ja.path),h,c)},xf.prototype.get=function(t){var e=this;oi("DocumentReference.get",arguments,0,1),ip("DocumentReference.get",t);var n=this.firestore.Uh();return t&&"cache"===t.source?n.Ah(this.ja).then(function(t){return new _f(e.firestore,e.ja,t,!0,t instanceof Na&&t.Ye,e.Wa)}):n.Rh(this.ja,t).then(function(t){return e.ul(t)})},xf.prototype.withConverter=function(t){return new xf(this.ja,this.firestore,t)},xf.prototype.ul=function(t){var e=t.docs.get(this.ja);return new _f(this.firestore,this.ja,e,t.fromCache,t.hasPendingWrites,this.Wa)},xf),Vf=(Mf.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Mf),_f=(jf.prototype.data=function(t){var e=this;if(oi("DocumentSnapshot.data",arguments,0,1),t=rp("DocumentSnapshot.data",t),this.cl){if(this.Wa){var n=new Uf(this.nl,this.ja,this.cl,this.al,this.hl,null);return this.Wa.fromFirestore(n,t)}return new Rf(this.nl.Qa,this.nl.tl(),t.serverTimestamps||"none",function(t){return new Pf(t,e.nl,null)},function(t){return new Vi(t)}).Ch(this.cl.sn())}},jf.prototype.get=function(t,e){var n=this;if(oi("DocumentSnapshot.get",arguments,1,2),e=rp("DocumentSnapshot.get",e),this.cl){var r=this.cl.data().field(pf("DocumentSnapshot.get",t,this.ja));if(null!==r)return new Rf(this.nl.Qa,this.nl.tl(),e.serverTimestamps||"none",function(t){return new Pf(t,n.nl,n.Wa)},function(t){return new Vi(t)}).Ch(r)}},Object.defineProperty(jf.prototype,"id",{get:function(){return this.ja.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(jf.prototype,"ref",{get:function(){return new Pf(this.ja,this.nl,this.Wa)},enumerable:!1,configurable:!0}),Object.defineProperty(jf.prototype,"exists",{get:function(){return null!==this.cl},enumerable:!1,configurable:!0}),Object.defineProperty(jf.prototype,"metadata",{get:function(){return new Vf(this.hl,this.al)},enumerable:!1,configurable:!0}),jf.prototype.isEqual=function(t){if(!(t instanceof jf))throw gi("isEqual","DocumentSnapshot",1,t);return this.nl===t.nl&&this.al===t.al&&this.ja.isEqual(t.ja)&&(null===this.cl?null===t.cl:this.cl.isEqual(t.cl))&&this.Wa===t.Wa},jf),Uf=(o(Cf,Af=_f),Cf.prototype.data=function(t){return Af.prototype.data.call(this,t)},Cf);function Cf(){return null!==Af&&Af.apply(this,arguments)||this}function jf(t,e,n,r,i,o){this.nl=t,this.ja=e,this.cl=n,this.al=r,this.hl=i,this.Wa=o}function Mf(t,e){this.hasPendingWrites=t,this.fromCache=e}function xf(t,e,n){var r=this;return(r=Nf.call(this,e.Qa,t,n)||this).ja=t,r.firestore=e,r.Wa=n,r.Bh=r.firestore.Uh(),r}function Bf(t){this.nl=t,this.il=[],this.rl=!1}function Ff(t,e){this.nl=t,this.sl=e}function qf(t,e,n,r){var i=this;if(void 0===n&&(n=new pl),void 0===r&&(r=new dl),this.Oh=n,this.Mh=r,this.Lh=null,this.qh=new Pu,this.INTERNAL={delete:function(){return w(i,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.Uh(),[4,this.Bh.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.Lh=o,this.Qa=qf.Qh(o),this.jh=o.name,this.Wh=new Dh(e)}else{var s=t;if(!s.projectId)throw new Or(Lr.INVALID_ARGUMENT,"Must provide projectId");this.Qa=new _i(s.projectId,s.database),this.jh="[DEFAULT]",this.Wh=new kh}this.Gh=new kf({})}function Gf(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Or(Lr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ui("settings","non-empty string","host",t.host),this.host=t.host,hi("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(yi("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),hi("settings","object","credentials",t.credentials),this.credentials=t.credentials,hi("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),hi("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?jr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&jr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,hi("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=$u.Mi;else{if(t.cacheSizeBytes!==Sf&&t.cacheSizeBytes<$u.Oi)throw new Or(Lr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+$u.Oi);this.cacheSizeBytes=t.cacheSizeBytes}hi("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function zf(t,e,n,r,i){this.B=t,this.timestampsInSnapshots=e,this.Vh=n,this.bh=r,this.Sh=i}function Wf(t,e,n){if("string"==typeof n){if(""===n)throw new Or(Lr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ja(e)&&-1!==n.indexOf("/"))throw new Or(Lr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Xr.P(n));if(!Jr.N(r))throw new Or(Lr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Zo(t,new Jr(r))}if(n instanceof Fl)return Zo(t,n.ja);throw new Or(Lr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+di(n)+".")}function Qf(t,e){if(!Array.isArray(t)||0===t.length)throw new Or(Lr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Or(Lr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Or(Lr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Or(Lr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Hf(t,e,n){if(!n.isEqual(e))throw new Or(Lr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Xf(t){if(_a(t)&&0===t.rn.length)throw new Or(Lr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Yf,Kf=(ep.prototype.where=function(t,e,n){ri("Query.where",arguments,3),vi("Query.where",3,n);var r,i,o=li("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),s=pf("Query.where",t),a=function(t,e,n,r,i,o,s){var a;if(i.V()){if("array-contains"===o||"array-contains-any"===o)throw new Or(Lr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Qf(s,o);for(var u=[],h=0,c=s;h<c.length;h++){var l=c[h];u.push(Wf(r,t,l))}a={arrayValue:{values:u}}}else a=Wf(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Qf(s,o),a=uf(n,e,s,"in"===o||"not-in"===o);var f=Ya.create(i,o,a);return function(t,e){if(e.an()){var n=Ca(t);if(null!==n&&!n.isEqual(e.field))throw new Or(Lr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Ua(t);null!==r&&Hf(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new Or(Lr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Or(Lr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(this.ll,"Query.where",this.firestore.zh,this.firestore.Qa,s,o,n);return new ep((r=this.ll,i=r.filters.concat([a]),new ka(r.path,r.collectionGroup,r.rn.slice(),i,r.limit,r.on,r.startAt,r.endAt)),this.firestore,this.Wa)},ep.prototype.orderBy=function(t,e){var n;if(oi("Query.orderBy",arguments,1,2),ai("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Or(Lr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=pf("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Or(Lr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Or(Lr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o,s=new Tu(e,n);return i=s,null!==Ua(r=t)||null!==(o=Ca(r))&&Hf(0,o,i.field),s}(this.ll,o,n);return new ep((r=this.ll,i=r.rn.concat([s]),new ka(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.on,r.startAt,r.endAt)),this.firestore,this.Wa)},ep.prototype.limit=function(t){return ri("Query.limit",arguments,1),si("Query.limit","number",1,t),mi("Query.limit",1,t),new ep(Ba(this.ll,t,"F"),this.firestore,this.Wa)},ep.prototype.limitToLast=function(t){return ri("Query.limitToLast",arguments,1),si("Query.limitToLast","number",1,t),mi("Query.limitToLast",1,t),new ep(Ba(this.ll,t,"L"),this.firestore,this.Wa)},ep.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ii("Query.startAt",arguments,1);var r=this._l("Query.startAt",t,e,!0);return new ep(Fa(this.ll,r),this.firestore,this.Wa)},ep.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ii("Query.startAfter",arguments,1);var r=this._l("Query.startAfter",t,e,!1);return new ep(Fa(this.ll,r),this.firestore,this.Wa)},ep.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ii("Query.endBefore",arguments,1);var r=this._l("Query.endBefore",t,e,!0);return new ep(qa(this.ll,r),this.firestore,this.Wa)},ep.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ii("Query.endAt",arguments,1);var r=this._l("Query.endAt",t,e,!1);return new ep(qa(this.ll,r),this.firestore,this.Wa)},ep.prototype.isEqual=function(t){if(!(t instanceof ep))throw gi("isEqual","Query",1,t);return this.firestore===t.firestore&&Ga(this.ll,t.ll)&&this.Wa===t.Wa},ep.prototype.withConverter=function(t){return new ep(this.ll,this.firestore,t)},ep.prototype._l=function(c,t,e,n){if(vi(c,1,t),t instanceof _f)return ri(c,s([t],e),1),function(t,e,n,r){if(!n)throw new Or(Lr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Ma(t);o<s.length;o++){var a=s[o];if(a.field.V())i.push(Zo(e,n.key));else{var u=n.field(a.field);if(Bo(u))throw new Or(Lr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var h=a.field.R();throw new Or(Lr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}i.push(u)}}return new vu(i,r)}(this.ll,this.firestore.Qa,t.cl,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Or(Lr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var h=i[u];if(s[u].field.V()){if("string"!=typeof h)throw new Or(Lr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!ja(t)&&-1!==h.indexOf("/"))throw new Or(Lr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Xr.P(h));if(!Jr.N(c))throw new Or(Lr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new Jr(c);a.push(Zo(e,l))}else{var f=uf(n,r,h);a.push(f)}}return new vu(a,o)}(this.ll,this.firestore.Qa,this.firestore.zh,c,r,n)},ep.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];oi("Query.onSnapshot",arguments,1,4);var s,a={},u=0;"object"!=typeof i[u]||Tf(i[u])||(yi("Query.onSnapshot",a=i[u],["includeMetadataChanges"]),hi("Query.onSnapshot","boolean","includeMetadataChanges",a.includeMetadataChanges),u++),Tf(i[u])?(s=i[u],i[u]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[u+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[u+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(si("Query.onSnapshot","function",u,i[u]),ai("Query.onSnapshot","function",u+1,i[u+1]),ai("Query.onSnapshot","function",u+2,i[u+2]));var h={next:function(t){i[u]&&i[u](new Jf(r.firestore,r.ll,t,r.Wa))},error:i[u+1],complete:i[u+2]};return Xf(this.ll),this.firestore.Uh().listen(this.ll,a,h)},ep.prototype.get=function(t){var e=this;oi("Query.get",arguments,0,1),ip("Query.get",t),Xf(this.ll);var n=this.firestore.Uh();return(t&&"cache"===t.source?n.yh(this.ll):n.Ph(this.ll,t)).then(function(t){return new Jf(e.firestore,e.ll,t,e.Wa)})},ep),Jf=(Object.defineProperty(tp.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(tp.prototype,"empty",{get:function(){return this.dl.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(tp.prototype,"size",{get:function(){return this.dl.docs.size},enumerable:!1,configurable:!0}),tp.prototype.forEach=function(e,n){var r=this;oi("QuerySnapshot.forEach",arguments,1,2),si("QuerySnapshot.forEach","function",1,e),this.dl.docs.forEach(function(t){e.call(n,r.Tl(t,r.metadata.fromCache,r.dl.Qt.has(t.key)))})},Object.defineProperty(tp.prototype,"query",{get:function(){return new Kf(this.fl,this.nl,this.Wa)},enumerable:!1,configurable:!0}),tp.prototype.docChanges=function(t){t&&(yi("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),hi("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.dl.Wt)throw new Or(Lr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.wl&&this.ml===e||(this.wl=function(i,e,o){if(i.Bt.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Bt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Br()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.dl,e,this.Tl.bind(this)),this.ml=e),this.wl},tp.prototype.isEqual=function(t){if(!(t instanceof tp))throw gi("isEqual","QuerySnapshot",1,t);return this.nl===t.nl&&Ga(this.fl,t.fl)&&this.dl.isEqual(t.dl)&&this.Wa===t.Wa},tp.prototype.Tl=function(t,e,n){return new Uf(this.nl,t.key,t,e,n,this.Wa)},tp),Zf=(o($f,Yf=Kf),Object.defineProperty($f.prototype,"id",{get:function(){return this.ll.path._()},enumerable:!1,configurable:!0}),Object.defineProperty($f.prototype,"parent",{get:function(){var t=this.ll.path.h();return t.m()?null:new Pf(new Jr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty($f.prototype,"path",{get:function(){return this.ll.path.R()},enumerable:!1,configurable:!0}),$f.prototype.doc=function(t){oi("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Ei.k()),si("CollectionReference.doc","non-empty string",1,t);var e=Xr.P(t);return Pf.Zh(this.ll.path.child(e),this.firestore,this.Wa)},$f.prototype.add=function(t){ri("CollectionReference.add",arguments,1);var e=this.Wa?this.Wa.toFirestore(t):t;si("CollectionReference.add","object",1,e);var n=this.doc();return new Pf(n.ja,this.firestore,null).set(e).then(function(){return n})},$f.prototype.withConverter=function(t){return new $f(this.El,this.firestore,t)},$f);function $f(t,e,n){var r=this;if(((r=Yf.call(this,Pa(t),e,n)||this).El=t).length%2!=1)throw new Or(Lr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function tp(t,e,n,r){this.nl=t,this.fl=e,this.dl=n,this.Wa=r,this.wl=null,this.ml=null,this.metadata=new Vf(n.hasPendingWrites,n.fromCache)}function ep(t,e,n){this.ll=t,this.firestore=e,this.Wa=n}function np(t,e){if(void 0===e)return{merge:!1};if(yi(t,e,["merge","mergeFields"]),hi(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new Or(Lr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+di(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new Or(Lr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+di(n[i]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof gl}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Or(Lr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function rp(t,e){return void 0===e?{}:(yi(t,e,["serverTimestamps"]),ci(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function ip(t,e){ai(t,"object",1,e),e&&(yi(t,e,["source"]),ci(t,0,"source",e.source,["default","server","cache"]))}function op(t,e,n){if(e instanceof Fl){if(e.firestore!==n)throw new Or(Lr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw gi(t,"DocumentReference",1,e)}function sp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var ap,up={Firestore:Df,GeoPoint:xl,Timestamp:Ci,Blob:Vi,Transaction:Lf,WriteBatch:Of,DocumentReference:Pf,DocumentSnapshot:_f,Query:Kf,QueryDocumentSnapshot:Uf,QuerySnapshot:Jf,CollectionReference:Zf,FieldPath:gl,FieldValue:jl,setLogLevel:Df.setLogLevel,CACHE_SIZE_UNLIMITED:Sf};(ap=r.default).INTERNAL.registerComponent(new Sr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Df(e,n,new pl,new dl);var e,n},"PUBLIC").setServiceProps(Object.assign({},up))),ap.registerVersion("@firebase/firestore","1.17.1-2020822235757")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
